var isIE=/msie/i.test(navigator.userAgent);function EditInfo(c,g,d,f,e,a,b){this.name=c;this.editNum=g;this.seperator=d;this.wordPerEdit=f;this.regex=e;this.IsAcceptKey=a;this.IsValidField=b}function MultiEdit(b,a){this.id=b;this.editType=a;this.editInfo=MultiEdit.EditInfo[a];this.editNum=this.editInfo.editNum;this.seperator=this.editInfo.seperator;this.onChange=new Function();this.onEnterKey=new Function();this.disabled=false;MultiEdit.all[b]=this}MultiEdit.all={};MultiEdit.EnabledClassName="multiEditInput";MultiEdit.DisabledClassName="multiEditInputDisabled";MultiEdit.EditInfo=new Array(new EditInfo("mac",6,"-",2,/^[0-9a-f]{2}(-[0-9a-f]{2}){5}$/i,IsMacAcceptKey,IsMacValidField),new EditInfo("ipv4",4,".",3,/^[\d]{1,3}(\.[\d]{1,3}){3}$/,IsIpAcceptKey,IsIpValidField),new EditInfo("ipv6",8,":",4,/^.*$/i,IsIPv6AcceptKey,IsIpv6ValidField),new EditInfo("ipv6",1,":",5,/^.*$/,IsIpAcceptKey,IsIpv6MaskValidField));MultiEdit.prototype={focus:function(a){if(!a){a=1}document.getElementById(this.id+"_"+a).focus()},setEnable:function(c){var a=!c;this.disabled=!c;var e=document.getElementById(this.id).getElementsByTagName("input");for(var d=0;d<e.length;d++){e[d].readOnly=a}document.getElementById(this.id).className=c?MultiEdit.EnabledClassName:MultiEdit.DisabledClassName},toString:function(){var a='<span  id="'+this.id+'" class="'+MultiEdit.EnabledClassName+'"  >';for(i=1;i<=this.editNum;i++){if(isIE){a+='<input  style = "width:50px" onkeypress="MultiEdit.evt.keypress(this,event)" onkeydown="MultiEdit.evt.keydown(this,event)" onfocus="MultiEdit.evt.focus(this,event)" onpaste="MultiEdit.evt.change(this,event);" oninput="MultiEdit.evt.change(this,event);" onchange="MultiEdit.evt.change(this,event),g_bChange = true;"  type="text" size=3  id="'+this.id+"_"+i+'" maxlength='+this.editInfo.wordPerEdit+"/>"}else{a+='<input  style = "width:50px" onkeypress="MultiEdit.evt.keypress(this,event)"  onfocus="MultiEdit.evt.focus(this,event)" onchange="MultiEdit.evt.change(this,event),g_bChange = true;"  onkeydown="MultiEdit.evt.keydown(this,event)" onpaste="MultiEdit.evt.change(this,event);" type="text" size=3  id="'+this.id+"_"+i+'" maxlength='+this.editInfo.wordPerEdit+"/>"}if(i<this.editNum){a+=this.seperator}}a+="</span>";return a},getValue:function(){var a=new Array(this.editNum);for(var b=1;b<=this.editNum;b++){a[b-1]=document.getElementById(this.id+"_"+b).value}return a.join(this.seperator)},setValue:function(b){if(b.search(this.editInfo.regex)!=-1){b=b.split(this.seperator);for(var a=1;a<=this.editNum;a++){document.getElementById(this.id+"_"+a).value="0000".substr(0,this.editInfo.wordPerEdit-b[a-1].length)+b[a-1]}}else{for(var a=1;a<=this.editNum;a++){document.getElementById(this.id+"_"+a).value="0000".substr(0,this.editInfo.wordPerEdit)}}}};MultiEdit.evt={focus:function(b,a){b.select()},change:function(c,a){var b=c.id.replace(/_\d$/,"");if(MultiEdit.all[b].editInfo.IsValidField(c.value)){c.value="0000".substr(0,MultiEdit.all[b].editInfo.wordPerEdit-c.value.length)+c.value}else{c.value="0000".substr(0,MultiEdit.all[b].editInfo.wordPerEdit)}MultiEdit.all[b].onChange();g_bNetworkPassTest=false},keypress:function(d,k){var a=d.id;/(.*)_(\d)$/.test(a);var e=RegExp.$2;var b=RegExp.$1;var j=k.charCode||k.keyCode;var g=MultiEdit.evt.getSelection(d);var h=d.value;var f=String.fromCharCode(j);if(MultiEdit.all[b].editInfo.IsAcceptKey(j)){h=""+h.substring(0,g.start)+f+h.substring(g.end,h.length);if(MultiEdit.all[b].editInfo.IsValidField(h)){if(h.length>=MultiEdit.all[b].editInfo.wordPerEdit){if(parseInt(e,10)<MultiEdit.all[b].editNum){a=a.replace(/(\d)$/,parseInt(e,10)+1);setTimeout("document.getElementById('"+a+"').focus();document.getElementById('"+a+"').select();",200)}}setTimeout("MultiEdit.all['"+b+"'].onChange()",0);return true}else{if(k.preventDefault){k.preventDefault()}k.returnValue=false;return false}}else{if(k.preventDefault){k.preventDefault()}k.returnValue=false}},keydown:function(d,k){var j=k.charCode||k.keyCode;var g=MultiEdit.evt.getSelection(d);var h=d.value;var f=String.fromCharCode(j);var a=d.id;/^(.*)_(\d)$/.test(a);var e=RegExp.$2;var b=RegExp.$1;switch(j){case 110:case 190:if(e<MultiEdit.all[b].editNum){a=a.replace(/(\d)$/,parseInt(e,10)+1);document.getElementById(a).focus();document.getElementById(a).select()}break;case 8:if(g.start>0){return}case 38:case 37:if(g.end==0&&e>MultiEdit.all[b].editNum){a=a.replace(/(\d)$/,parseInt(e,10)-1);document.getElementById(a).focus();document.getElementById(a).select()}break;case 39:case 40:if(g.start==h.length&&e<MultiEdit.all[b].editNum){a=a.replace(/(\d)$/,parseInt(e,10)+1);document.getElementById(a).focus();document.getElementById(a).select()}break}},getSelection:function(e){var a=this;if(e.createTextRange){var b=document.selection.createRange().duplicate();b.moveStart("character",-e.value.length);var d=b.text.length;var b=document.selection.createRange().duplicate();b.moveEnd("character",e.value.length);var c=e.value.lastIndexOf(b.text);if(b.text==""){c=e.value.length}return{start:c,end:d}}else{return{start:e.selectionStart,end:e.selectionEnd}}}};function IsMacAcceptKey(a){if((a>=48&&a<=57)||(a>=65&&a<=70)||(a>=97&&a<=102)){return true}return false}function IsIpAcceptKey(a){if(a>=48&&a<=57){return true}return false}function IsMacValidField(a){return true}function IsIpValidField(b){var a=parseInt(b,10);if(a>=0&&b<=255){return true}return false}function IsIPv6AcceptKey(a){if((a>=48&&a<=57)||(a>=65&&a<=70)||(a>=97&&a<=102)){return true}return false}function IsIpv6ValidField(a){return true}function IsIpv6MaskValidField(b){var a=parseInt(b,10);if(a>=0&&b<=65535){return true}return false};
function OnLoadCfgAdvance(){ApplyXmlLang("cfg_advance.xml");if(!g_supportFunctions.IsSupportConfigImport()){id_config_io.rows[2].style.display="none";id_config_io.rows[3].style.display="none";id_config_io.rows[4].style.display="none"}if(!g_supportFunctions.IsSupportConfigExport()){id_config_io.rows[0].style.display="none";id_config_io.rows[1].style.display="none";id_config_io.rows[2].style.display="none"}Align()}function OnLoadCfgAdvanceBan(){var d=document.getElementById("id_bw_cfg");ApplyXmlLang("cfg_advance_ban.xml");CreateListBW(d,4,new Array("",str_num,str_startip,str_endip),const_ban_allow_num);var b=CreateConfigReqXml(sch_advance_array);var a=WebClient.ExcuteCmd(b);if(a==""){return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);g_xmlDoc.async=false;var c=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateValues(c,true);UpdateBWList(c,true);Align()}function LoadDefaultCfgAdvance(){if(GetDefaultCfg(sch_advance_array)){var a=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateValues(a,true);UpdateBWList(a,true);g_bChange=true}}function BrowseExportFile(){var a=document.getElementById("config_export_path");a.value=WebClient.BrowseFile(0)}function BrowseImportFile(){var a=document.getElementById("config_file_path");a.value=WebClient.BrowseFile(1)}function OnExportCfg(){var a=document.getElementById("config_export_path");if(a.value==""){return}StartWaitTip(str_export_wait);setTimeout("ExportCfg()",100)}function OnImportCfg(){if(!confirm(str_boot_to_effect_request)){return}var a=document.getElementById("config_file_path");if(a.value==""){return}StartWaitTip(str_import_wait);setTimeout("ImportCfg()",100)}function ExportCfg(){var a=document.getElementById("config_export_path");var f="<request>\r\n";f+='<command name="'+STR_LM_CFG_EXPORT+'">\r\n';f+="<"+STR_PATH+">"+a.value+"</"+STR_PATH+">\r\n";f+="</command>\r\n";f+="</request>\r\n";var d=WebClient.ExcuteLocalCmd(f);StopWaitTip();if(d==""){window.alert(str_local_export_failed);return}var c;c=FormatToXmlDOM(d);c.async=false;var e=c.documentElement.getElementsByTagName("command");var b=e[0].getElementsByTagName("parameter")[0];if(b.childNodes[0].nodeValue!="1"){window.alert(str_local_export_failed)}else{window.alert(str_export_finish)}delete c}function ImportCfg(){var a=document.getElementById("config_file_path");var f="<request>\r\n";f+='<command name="'+STR_LM_CFG_IMPORT+'">\r\n';f+="<"+STR_PATH+">"+a.value+"</"+STR_PATH+">\r\n";f+="</command>\r\n";f+="</request>\r\n";var d=WebClient.ExcuteLocalCmd(f);StopWaitTip();if(d==""){window.alert(str_local_import_failed);return}var c;c=FormatToXmlDOM(d);c.async=false;var e=c.documentElement.getElementsByTagName("command");var b=e[0].getElementsByTagName("parameter")[0];if(b.childNodes[0].nodeValue!="1"){window.alert(str_local_import_failed)}else{window.alert(str_import_finish);var f="<request>\r\n";f+='<command name="'+STR_REQUEST_REBOOT+'">\r\n';f+="</command>\r\n";f+="</request>\r\n";WebClient.ExcuteCmd(f)}delete c}function CreateListBW(j,a,b,o){var d=/msie/i.test(navigator.userAgent);var m=j.outerHTML.toLowerCase();var c=m.indexOf("</tbody>");m=m.substr(0,c);m+="<tr class = 'table_head_bgcolor'>";for(var f=0;f<a;f++){m+='<td style = "text-align:center">'+b[f]+"</td>"}m+="</tr>";for(var f=1;f<o+1;f++){if(d){m+="<tr>";m+='<td><input type = "checkbox"  name = "bw_checked" onchange = "g_bChange = true;"/></td>';m+='<td style = "width:70px;text-align:center">'+f+"</td>";m+='<td style = "width:285px"><span  id = "start_ip"/></td>';m+='<td style = "width:285px"><span  id = "end_ip"/></td>';m+="</tr>"}else{m+="<tr>";m+='<td style = "width:70px;text-align:center"><input type = "checkbox"  name = "bw_checked" style = "width:30px;" onchange = "g_bChange = true;"/></td>';m+='<td style = "width:70px;text-align:center">'+f+"</td>";m+='<td style = "width:285px"><span  name = "start_ip"></span></td>';m+='<td style = "width:285px"><span  name = "end_ip"></span></td>';m+="</tr>"}}m+="</tbody></table>";if(d){var g=j.parentElement}else{var g=j.parentNode}g.innerHTML=m;j=g.childNodes[0];var h=document.getElementsByName("start_ip");var l=document.getElementsByName("end_ip");for(var f=0;f<o;f++){var e=new MultiEdit("ipstart"+f,1);h[f].innerHTML=e;h[f].ipName="ipstart"+f;var n=new MultiEdit("ipend"+f,1);l[f].innerHTML=n;l[f].ipName="ipend"+f}}function UpdateBWList(n,b){var d=document.getElementsByName("bw_checked");var h=document.getElementsByName("start_ip");var m=document.getElementsByName("end_ip");for(i=0;i<n.length;i++){if(b){if(STR_IP_LIST_CHECKED==n[i].attributes.getNamedItem("name").nodeValue){var l=document.getElementsByName(STR_IP_LIST_CHECKED);for(k=0;k<l.length;k++){if(l[k].value==n[i].childNodes[0].nodeValue){l[k].checked=true;break}}}if(STR_IP_MODE_INFO==n[i].attributes.getNamedItem("name").nodeValue){var e=n[i].attributes.getNamedItem("index").nodeValue;var f=n[i].childNodes[0].nodeValue;var a=f.split("+");c=parseInt(a[0],10);d[e].checked=c?1:0;MultiEdit.all[h[e].ipName].setValue(a[1]);MultiEdit.all[m[e].ipName].setValue(a[2])}}else{if(STR_IP_LIST_CHECKED==n[i].attributes.getNamedItem("name").nodeValue){var l=document.getElementsByName(STR_IP_LIST_CHECKED);for(k=0;k<l.length;k++){if(l[k].checked){n[i].childNodes[0].nodeValue=l[k].value;break}}}if(STR_IP_MODE_INFO==n[i].attributes.getNamedItem("name").nodeValue){var e=n[i].attributes.getNamedItem("index").nodeValue;n[i].childNodes[0].nodeValue="";var c=(d[e].checked)?1:0;var j=MultiEdit.all[h[e].ipName].getValue();var g=MultiEdit.all[m[e].ipName].getValue();n[i].childNodes[0].nodeValue=c+"+"+j+"+"+g}}}};
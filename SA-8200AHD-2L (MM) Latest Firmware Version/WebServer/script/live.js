var g_liveSelChannel=-1;var g_queryHandle=0;var g_ptzSpeed=4;var g_preAction=CreatePreAction();var g_preBrushAction=CreatePreAction();var g_preLampAction=CreatePreAction();var g_ptzPresetList=null;var g_ptzCruiseList=null;var g_bCurChannelHide=0;var g_ptzCtrlXmlDoc=createXMLDoc();function PTZErrors(){this.PTZ_ERR_OK=0;this.PTZ_ERR_WRITE_COM=1;this.PTZ_ERR_UF_PROTOCOL=2;this.PTZ_ERR_CHNN_LOCK=3;this.PTZ_ERR_CHNN_UN_INTERRUPT=4;this.PTZ_ERR_CHNN_UN_SET=5;this.PTZ_ERR_CHNN_UN_ENABLE=6;this.PTZ_ERR_CHNN_WAITING=7;this.PTZ_ERR_PRESET_DISABLE=8;this.PTZ_ERR_OPERATE_FAIL=9}var g_PtzErrors=new PTZErrors();function CreatePreAction(){var b=new Array();for(var a=0;a<g_ch_num;a++){b[a]=STR_PTZ_STOP_MOVE}return b}function doClick(e){var d=document.getElementById(e);if(document.createEvent){var b=document.createEvent("MouseEvents");b.initEvent("click",true,false);d.dispatchEvent(b)}else{if(document.createEventObject){var a=document.createEventObject();a.type="onmouseover";a.toElement=d;a.srcElement=d;var c=d.getBoundingClientRect();a.offsetX=(c.right+c.left)/2;a.offsetY=(c.bottom-c.top)/2;d.fireEvent("onmouseover",a)}}}function GotoLivePage(){if(g_mainMenuItem==3){HintSave(-1)}g_mainMenuItem=0;selected(g_mainMenuItem);HideDIVs();var a=/msie/i.test(navigator.userAgent);if(a){document.getElementById("ocx_alt_label").style.display=""}document.getElementById("div_main_menu").style.display="";document.getElementById("div_ocx").style.display="";WebClient.style.display="";g_xmlhttp.open("get","body_html/body_live.html",false);SafeHttpSend(g_xmlhttp,null);OnRecvLivePage()}function OnRecvLivePage(){if(g_xmlhttp.readyState==4){document.getElementById("div_live").innerHTML=g_xmlhttp.responseText;ApplyXmlLang("live.xml");var n=document.getElementById("live2");var y=document.getElementById("div_live1");var v=document.getElementById("div_live3");var A=parseInt(const_hardware_ver.split(".")[0],10);if((10640<=A&&A<=10682)||A==10690||A==10691||A==10710||A==10711||A==10712||A==10721||A==10722||A==10720||A==TD_2704TD_P||A==TD_2708TD_P||A==TD_2716TD_P||A==TD_2704TE_M||A==TD_2708TE_M||A==TD_2716TE_M){document.getElementById("live1").style.display="none";v.style.height=parseInt(v.style.height)+35+"px"}if(!g_supportFunctions.IsSupportPTZ()){n.style.display="none";y.style.height=parseInt(y.style.height)+35+"px";v.style.height=parseInt(v.style.height)+35+"px"}var k=/msie/i.test(navigator.userAgent);if(k){g_xmlhttp.open("get","script/ctrl_slider.js",false);SafeHttpSend(g_xmlhttp,null)}if(g_xmlhttp.readyState!=4){return}if(k){DynAppendJS("ctrl_slider_js",g_xmlhttp.responseText)}var l=document.getElementById("div_bright");var h=document.getElementById("bright_bk");var s=document.getElementById("bright_thumb");var o=document.getElementById("bright_tip");var z=document.getElementById("div_contrast");var C=document.getElementById("contrast_bk");var c=document.getElementById("contrast_thumb");var M=document.getElementById("contrast_tip");var w=document.getElementById("div_saturation");var g=document.getElementById("saturation_bk");var H=document.getElementById("saturation_thumb");var d=document.getElementById("saturation_tip");var G=document.getElementById("div_hue");var a=document.getElementById("hue_bk");var x=document.getElementById("hue_thumb");var e=document.getElementById("hue_tip");var L=document.getElementById("div_speed");var E=document.getElementById("speed_bk");var q=document.getElementById("speed_thumb");var J=document.getElementById("speed_tip");var j=document.getElementById("first_stream_table");var t=document.getElementById("web_rec_table");var m=document.getElementById("live3");var b=document.getElementById("logo_img_div");CreateSlider(l,h,s,o,0,255,SetVideoColor);CreateSlider(z,C,c,M,0,255,SetVideoColor);CreateSlider(w,g,H,d,0,255,SetVideoColor);CreateSlider(G,a,x,e,0,255,SetVideoColor);SetSliderPos(h,s,128);SetSliderPos(C,c,128);SetSliderPos(g,H,128);SetSliderPos(a,x,128);CreateSlider(L,E,q,J,1,8);SetSliderPos(E,q,g_ptzSpeed);g_ptzPresetList=new Array(g_ch_num);g_ptzCruiseList=new Array(g_ch_num);if(k){FillPresetAndCruiseList()}else{GetPresetAndCruiseList()}g_liveSelChannel=-1;WebClient.SetVisible(1);RecMouseout();if(k){FreshPtzState();FreshPtzBrushLampState()}liveNavCtrl(m);GenLiveTable(j);GenLiveTable(t);OnTimer();if(!const_support_talkback){document.getElementById("start_talk").style.display="none"}if(g_bTalking){document.getElementById("start_talk").style.display="none";document.getElementById("stop_talk").style.display=""}if(g_bUseLogo){b.innerHTML='<img style="cursor:auto;" src = "logo/logo.png" alt = ""/>'}var B=/win32/i.test(navigator.platform);if(!B){document.getElementById("clipplay_img").style.display="none"}document.getElementById("div_live").style.height="";document.getElementById("div_live").style.display="";var u=document.getElementById("div_live").offsetHeight;var F=document.getElementById("div_main_menu").offsetLeft+5;document.getElementById("div_ocx").style.left=F+"px";var I=document.getElementById("div_main_menu").offsetTop+document.getElementById("div_main_menu").offsetHeight;document.getElementById("div_ocx").style.top=I+"px";document.getElementById("div_ocx").style.width="770px";var r=document.getElementById("div_live").offsetHeight-5;document.getElementById("div_ocx").style.height="";var p=/msie/i.test(navigator.userAgent);var B=/win32/i.test(navigator.platform);if(p){document.getElementById("div_ocx").style.height="595px";document.getElementById("div_live").style.height="600px";WebClient.style.height="590px";WebClient.style.width="770px"}else{document.getElementById("div_ocx").style.height="630px";document.getElementById("div_live").style.height="640px";WebClient.style.height="630px";WebClient.style.width="770px";document.getElementById("work_area").style.height="670px";document.getElementById("work_area").style.width="980px";var D=/firefox/i.test(navigator.userAgent);var K=/chrome/i.test(navigator.userAgent);var f=/safari/i.test(navigator.userAgent);if(B){if(D){document.getElementById("div_live1").style.height="480px";document.getElementById("div_live2").style.height="480px";document.getElementById("div_live3").style.height="460px"}else{if(K||f){document.getElementById("div_live1").style.height="460px";document.getElementById("div_live2").style.height="460px";document.getElementById("div_live3").style.height="460px"}}}}}}function FreshPtzState(){var a=document.getElementById("ptz_track");var b=document.getElementById("ptz_auto_scan");a.src="res/startCruise1.jpg";b.src="res/startScan1.jpg";if(g_preAction[g_liveSelChannel]==STR_PTZ_START_TRACK){a.src="res/startCruise2.jpg"}if(g_preAction[g_liveSelChannel]==STR_PTZ_START_AUTOSCAN){b.src="res/startScan2.jpg"}}function FreshPtzBrushLampState(){var a=document.getElementById("ptz_brush");var d=document.getElementById("ptz_lamp");var c=document.getElementById("ptz_brush_on");var b=document.getElementById("ptz_lamp_on");a.style.display="";c.style.display="none";d.style.display="";b.style.display="none";if(g_preLampAction[g_liveSelChannel]==STR_PTZ_AUXILIARY_LAMP){d.style.display="none";b.style.display=""}if(g_preLampAction[g_liveSelChannel]==STR_PTZ_STOP_LAMP){d.style.display="";b.style.display="none"}if(g_preBrushAction[g_liveSelChannel]==STR_PTZ_AUXILIARY_BRUSH){a.style.display="none";c.style.display=""}if(g_preBrushAction[g_liveSelChannel]==STR_PTZ_STOP_BRUSH){a.style.display="";c.style.display="none"}}function GetPresetAndCruiseList(){SetNofityCallback(FillPresetAndCruiseList_Asyn);var b=CreateConfigReqXml(ptz_advance_array);var a=WebClient.ExcuteCmdAsyn(b);if(a!=""){FillPresetAndCruiseList_Asyn(a)}}function FillPresetAndCruiseList_Asyn(r){if(r==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(r);g_xmlDoc.async=false;var p=/msie/i.test(navigator.userAgent);var a=navigator.userAgent.toLowerCase();var g=navigator.platform.toLowerCase();var c=false;if(a.indexOf("macintosh")!=-1||a.indexOf("mac os x 10")!=-1||g.indexOf("macintel")!=-1){c=true}var o=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");for(i=0;i<o.length;i++){if(STR_PTZ_PRESET_INFO==o[i].attributes.getNamedItem("name").nodeValue){var l=o[i].attributes.getNamedItem("index").nodeValue;g_ptzPresetList[l]=new Array();g_ptzPresetList[l][0]=new CSelectOptionInfo(str_select,-1);if(o[i].childNodes[0]==null){continue}var u=o[i].childNodes[0].nodeValue;var n=0;while(u.length>0){if(p){var k=parseInt(u,10);var w=u.indexOf("+");u=u.substr(w+1);var b=parseInt(u,10);w=u.indexOf("+");u=u.substr(w+1);var v=parseInt(u,10);var s=u.indexOf(":");var m=u.SubStringOfBytes(s+1,v);u=u.substr(s+m.length+2);if(b!="0"){g_ptzPresetList[l][n+1]=new CSelectOptionInfo(m,k);n++}}else{var k=parseInt(u,10);var w=u.indexOf("+");u=u.substr(w+1);var b=parseInt(u,10);w=u.indexOf("+");u=u.substr(w+1);var v=parseInt(u,10);var s=u.indexOf(":");var m=u.SubStringOfBytes(s+1,v);if(c){if(m.length<v&&v%m.length!=0){v=v*2/3;m=u.SubStringOfBytes(s+1,v)}}u=u.substr(s+m.length+2);if(b!="0"){g_ptzPresetList[l][n+1]=new CSelectOptionInfo(m,k);n++}}}}if(STR_PTZ_CRUISE_INFO==o[i].attributes.getNamedItem("name").nodeValue){var l=o[i].attributes.getNamedItem("index").nodeValue;g_ptzCruiseList[l]=new Array();g_ptzCruiseList[l][0]=new CSelectOptionInfo(str_select,-1);if(o[i].childNodes[0]==null){continue}var e=o[i].childNodes[0].nodeValue;var n=0;while(e.length>0){if(p){var f=e.indexOf("(");var d=e.substr(f+1);var q=parseInt(d,10);f=d.indexOf("+");d=d.substr(f+1);var t=parseInt(d,10);f=d.indexOf(":");var j=d.SubStringOfBytes(f+1,t);d=d.substr(f+1+j.length);f=d.indexOf(")");e=d.substr(f+1);g_ptzCruiseList[l][n+1]=new CSelectOptionInfo(j,q);n++}else{var f=e.indexOf("(");var d=e.substr(f+1);var q=parseInt(d,10);f=d.indexOf("+");d=d.substr(f+1);var t=parseInt(d,10);f=d.indexOf(":");var j=d.SubStringOfBytes(f+1,t);if(c){if(j.length<t&&t%j.length!=0){t=t*2/3;j=d.SubStringOfBytes(f+1,t)}}d=d.substr(f+1+j.length);f=d.indexOf(")");e=d.substr(f+1);g_ptzCruiseList[l][n+1]=new CSelectOptionInfo(j,q);n++}}}}if(g_liveSelChannel!=-1){var x=document.getElementById("preset_list_live");var h=document.getElementById("cruise_list_live");x.length=0;h.length=0;GenSelectListEx(x,g_ptzPresetList[g_liveSelChannel]);GenSelectListEx(h,g_ptzCruiseList[g_liveSelChannel])}FreshPtzState();FreshPtzBrushLampState()}function stringToHex(c){var b="";for(var a=0;a<c.length;a++){if(b==""){b=c.charCodeAt(a).toString(16)}else{b+=","+c.charCodeAt(a).toString(16)}}return b}function FillPresetAndCruiseList(){var m="<request>\r\n";m+='<command name="'+STR_REQUEST_CONFIG_GET+'">\r\n';m+='<parameter name="config_item">'+STR_PTZ_PRESET_INFO+"</parameter>\r\n";m+='<parameter name="config_item">'+STR_PTZ_CRUISE_INFO+"</parameter>\r\n";m+="</command>\r\n";m+="</request>\r\n";var p=WebClient.ExcuteCmd(m);if(p==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(p);g_xmlDoc.async=false;var o=g_xmlDoc.documentElement.getElementsByTagName("command")[0];if(o.getAttribute("name")==STR_REPLY_CONFIG_FAIL){document.getElementById("live2").disabled=true;return}var l=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");for(i=0;i<l.length;i++){if(STR_PTZ_PRESET_INFO==l[i].attributes.getNamedItem("name").nodeValue){var h=l[i].attributes.getNamedItem("index").nodeValue;g_ptzPresetList[h]=new Array();g_ptzPresetList[h][0]=new CSelectOptionInfo(str_select,-1);if(l[i].childNodes[0]==null){continue}var s=l[i].childNodes[0].nodeValue;var k=0;while(s.length>0){var g=parseInt(s,10);var u=s.indexOf("+");s=s.substr(u+1);var a=parseInt(s,10);u=s.indexOf("+");s=s.substr(u+1);var t=parseInt(s,10);var q=s.indexOf(":");var j=s.SubStringOfBytes(q+1,t);s=s.substr(q+j.length+2);if(a!="0"){g_ptzPresetList[h][k+1]=new CSelectOptionInfo(j,g);k++}}}if(STR_PTZ_CRUISE_INFO==l[i].attributes.getNamedItem("name").nodeValue){var h=l[i].attributes.getNamedItem("index").nodeValue;g_ptzCruiseList[h]=new Array();g_ptzCruiseList[h][0]=new CSelectOptionInfo(str_select,-1);if(l[i].childNodes[0]==null){continue}var b=l[i].childNodes[0].nodeValue;var k=0;while(b.length>0){var d=b.indexOf("(");var c=b.substr(d+1);var n=parseInt(c,10);d=c.indexOf("+");c=c.substr(d+1);var r=parseInt(c,10);d=c.indexOf(":");var f=c.SubStringOfBytes(d+1,r);c=c.substr(d+1+f.length);d=c.indexOf(")");b=c.substr(d+1);g_ptzCruiseList[h][k+1]=new CSelectOptionInfo(f,n);k++}}}if(g_liveSelChannel!=-1){var v=document.getElementById("preset_list_live");var e=document.getElementById("cruise_list_live");v.length=0;e.length=0;GenSelectListEx(v,g_ptzPresetList[g_liveSelChannel]);GenSelectListEx(e,g_ptzCruiseList[g_liveSelChannel])}}function CreateReqManualRecXml(){var c="<request>\r\n";c+='<command name="'+STR_REQUEST_MANUAL_REC+'">\r\n';var b=new Array(64);for(var a=0;a<g_ch_num;a++){b[a]="1"}for(a=g_ch_num;a<64;a++){b[a]="0"}c+='<parameter name="'+STR_REC_CHANNELS+'">'+b.join("")+"</parameter>\r\n";c+="</command>\r\n";c+="</request>\r\n";return c}function PtzTrackmouseout(){var a=document.getElementById("ptz_track");if(g_preAction[g_liveSelChannel]!=STR_PTZ_START_TRACK){a.src="res/startCruise1.jpg"}}function PtzAutoScanmouseout(){var a=document.getElementById("ptz_auto_scan");if(g_preAction[g_liveSelChannel]!=STR_PTZ_START_AUTOSCAN){a.src="res/startScan1.jpg"}}function RunLampBrushCtrl(d){if(g_liveSelChannel==-1){return false}if(d==STR_PTZ_AUXILIARY_BRUSH){g_preBrushAction[g_liveSelChannel]=STR_PTZ_AUXILIARY_BRUSH}if(d==STR_PTZ_AUXILIARY_LAMP){g_preLampAction[g_liveSelChannel]=STR_PTZ_AUXILIARY_LAMP}if(d==STR_PTZ_STOP_LAMP){g_preLampAction[g_liveSelChannel]=STR_PTZ_STOP_LAMP}if(d==STR_PTZ_STOP_BRUSH){g_preBrushAction[g_liveSelChannel]=STR_PTZ_STOP_BRUSH}try{g_ptzSpeed=GetSliderPos(speed_bk,speed_thumb)}catch(g){g_ptzSpeed=0}var a="<request>\r\n";a+='<command name="'+STR_PTZ_CONTROL+'">\r\n';a+="<channel>"+g_liveSelChannel+"</channel>\r\n";a+="<action>"+d+"</action>\r\n";a+="<speed>"+g_ptzSpeed+"</speed>\r\n";a+="</command>\r\n";a+="</request>\r\n";var c=WebClient.ExcuteCmd(a);if(c!=""){if(g_ptzCtrlXmlDoc!=null){delete g_ptzCtrlXmlDoc;g_ptzCtrlXmlDoc=null}g_ptzCtrlXmlDoc=FormatToXmlDOM(c);g_ptzCtrlXmlDoc.async=false;var b=g_ptzCtrlXmlDoc.documentElement.getElementsByTagName("command")[0];if(b.attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth);return false}else{if(b.attributes.getNamedItem("name").nodeValue==STR_PTZ_CONTROL){var f=b.getElementsByTagName("error_code")[0].childNodes[0].nodeValue;if(f!=g_PtzErrors.PTZ_ERR_OK){if(g_PtzErrors.PTZ_ERR_OPERATE_FAIL==f){window.alert(str_config_by_other)}else{window.alert(str_ptz_control_failed)}return false}}}}if(g_mainMenuItem==0){FreshPtzBrushLampState()}}function RunPTZCtrl(d,h){if(g_liveSelChannel==-1){return false}if(STR_PTZ_STOP_MOVE==d){if((STR_PTZ_LEFT!=g_preAction[g_liveSelChannel])&&(STR_PTZ_RIGHT!=g_preAction[g_liveSelChannel])&&(STR_PTZ_UP!=g_preAction[g_liveSelChannel])&&(STR_PTZ_DOWN!=g_preAction[g_liveSelChannel])&&(STR_PTZ_LEFT_UP!=g_preAction[g_liveSelChannel])&&(STR_PTZ_LEFT_DOWN!=g_preAction[g_liveSelChannel])&&(STR_PTZ_RIGHT_UP!=g_preAction[g_liveSelChannel])&&(STR_PTZ_RIGHT_DOWN!=g_preAction[g_liveSelChannel])&&(STR_PTZ_FOCUS_NEAR!=g_preAction[g_liveSelChannel])&&(STR_PTZ_FOCUS_FAR!=g_preAction[g_liveSelChannel])&&(STR_PTZ_ZOOM_IN!=g_preAction[g_liveSelChannel])&&(STR_PTZ_ZOOM_OUT!=g_preAction[g_liveSelChannel])&&(STR_PTZ_IRIS_OPEN!=g_preAction[g_liveSelChannel])&&(STR_PTZ_IRIS_CLOSE!=g_preAction[g_liveSelChannel])){return false}}if(g_preAction[g_liveSelChannel]==STR_PTZ_START_TRACK){if(d==STR_PTZ_START_TRACK){d=STR_PTZ_STOP_TRACK}}if(g_preAction[g_liveSelChannel]==STR_PTZ_START_AUTOSCAN){if(d==STR_PTZ_START_AUTOSCAN){d=STR_PTZ_STOP_AUTOSCAN}}try{g_ptzSpeed=GetSliderPos(document.getElementById("speed_bk"),document.getElementById("speed_thumb"))}catch(g){g_ptzSpeed=0}var a="<request>\r\n";a+='<command name="'+STR_PTZ_CONTROL+'">\r\n';a+="<channel>"+g_liveSelChannel+"</channel>\r\n";a+="<action>"+d+"</action>\r\n";a+="<speed>"+g_ptzSpeed+"</speed>\r\n";if(d==STR_PTZ_GO_PRESET){if((h=="")||(h=="-1")){return false}a+="<"+STR_PTZ_PRESET+">"+h+"</"+STR_PTZ_PRESET+">\r\n"}if(d==STR_PTZ_RUN_CRUISE){if(h=="-1"){return false}a+="<"+STR_PTZ_CRUISE+">"+h+"</"+STR_PTZ_CRUISE+">\r\n"}a+="</command>\r\n";a+="</request>\r\n";var c=WebClient.ExcuteCmd(a);if(c!=""){if(g_ptzCtrlXmlDoc!=null){delete g_ptzCtrlXmlDoc;g_ptzCtrlXmlDoc=null}g_ptzCtrlXmlDoc=FormatToXmlDOM(c);g_ptzCtrlXmlDoc.async=false;var b=g_ptzCtrlXmlDoc.documentElement.getElementsByTagName("command")[0];if(b.attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth);return false}else{if(b.attributes.getNamedItem("name").nodeValue==STR_PTZ_CONTROL){var f=b.getElementsByTagName("error_code")[0].childNodes[0].nodeValue;if(f!=g_PtzErrors.PTZ_ERR_OK){if(g_PtzErrors.PTZ_ERR_OPERATE_FAIL==f){window.alert(str_config_by_other)}else{window.alert(str_ptz_control_failed)}return false}}}}g_preAction[g_liveSelChannel]=d;if(g_mainMenuItem==0){FreshPtzState()}return true}function GetVideoColor(){var b="<request>\r\n";b+='<command name="'+STR_GET_COLOR+'">\r\n';b+="<channel>"+g_liveSelChannel+"</channel>\r\n";b+="</command>\r\n";b+="</request>\r\n";var a=WebClient.ExcuteCmd(b);if(a!=""){FlushVideoColor(a)}}function SetVideoColor(){var q=document.getElementById("bright_bk");var o=document.getElementById("bright_thumb");var l=document.getElementById("contrast_bk");var k=document.getElementById("contrast_thumb");var a=document.getElementById("saturation_bk");var j=document.getElementById("saturation_thumb");var e=document.getElementById("hue_bk");var p=document.getElementById("hue_thumb");var n="<request>\r\n";n+='<command name="'+STR_SET_COLOR+'">\r\n';n+="<"+STR_CHANNEL+">"+g_liveSelChannel+"</"+STR_CHANNEL+">\r\n";var m=GetSliderPos(q,o);var f=GetSliderPos(l,k);var g=GetSliderPos(a,j);var h=GetSliderPos(e,p);var c=true;if((f<20)||((m*m+g*8+f*f*2)<10000)){c=false;return}if(c){n+="<"+STR_BRIGHT+">"+m+"</"+STR_BRIGHT+">\r\n";n+="<"+STR_CONTRAST+">"+f+"</"+STR_CONTRAST+">\r\n";n+="<"+STR_SATURATION+">"+g+"</"+STR_SATURATION+">\r\n";n+="<"+STR_HUE+">"+h+"</"+STR_HUE+">\r\n";n+="</command>\r\n";n+="</request>\r\n";var d=WebClient.ExcuteCmd(n)}if(d!=""){if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(d);g_xmlDoc.async=false;var b=g_xmlDoc.documentElement.getElementsByTagName("command");if(b[0].attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){document.fireEvent("onmouseup");g_bSliderDrag=false;window.alert(str_no_auth);return false}}SaveVideoColor();return true}function SaveVideoColor(){var p=document.getElementById("bright_bk");var n=document.getElementById("bright_thumb");var k=document.getElementById("contrast_bk");var j=document.getElementById("contrast_thumb");var a=document.getElementById("saturation_bk");var h=document.getElementById("saturation_thumb");var d=document.getElementById("hue_bk");var o=document.getElementById("hue_thumb");var m="<request>\r\n";m+='<command name="'+STR_SAVE_COLOR+'">\r\n';m+="<"+STR_CHANNEL+">"+g_liveSelChannel+"</"+STR_CHANNEL+">\r\n";var l=GetSliderPos(p,n);var e=GetSliderPos(k,j);var f=GetSliderPos(a,h);var g=GetSliderPos(d,o);m+="<"+STR_BRIGHT+">"+l+"</"+STR_BRIGHT+">\r\n";m+="<"+STR_CONTRAST+">"+e+"</"+STR_CONTRAST+">\r\n";m+="<"+STR_SATURATION+">"+f+"</"+STR_SATURATION+">\r\n";m+="<"+STR_HUE+">"+g+"</"+STR_HUE+">\r\n";m+="</command>\r\n";m+="</request>\r\n";var c=WebClient.ExcuteCmd(m);if(c!=""){if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(c);g_xmlDoc.async=false;var b=g_xmlDoc.documentElement.getElementsByTagName("command");if(b[0].attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth)}}}function SetDefaultVideoColor(){var b=document.getElementById("bright_bk");var e=document.getElementById("bright_thumb");var f=document.getElementById("contrast_bk");var h=document.getElementById("contrast_thumb");var d=document.getElementById("saturation_bk");var g=document.getElementById("saturation_thumb");var c=document.getElementById("hue_bk");var a=document.getElementById("hue_thumb");if(!(g_authority.authority&256)){window.alert(str_no_auth);return false}SetSliderPos(b,e,parseInt(g_colorInfo.bright,10));SetSliderPos(f,h,parseInt(g_colorInfo.contrast,10));SetSliderPos(d,g,parseInt(g_colorInfo.saturation,10));SetSliderPos(c,a,parseInt(g_colorInfo.hue,10));SetVideoColor();return true}function FlushVideoColor(g){var o=document.getElementById("bright_bk");var n=document.getElementById("bright_thumb");var j=document.getElementById("contrast_bk");var h=document.getElementById("contrast_thumb");var a=document.getElementById("saturation_bk");var f=document.getElementById("saturation_thumb");var b=document.getElementById("hue_bk");var m=document.getElementById("hue_thumb");if(g==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(g);g_xmlDoc.async=false;var k=g_xmlDoc.documentElement.getElementsByTagName("command")[0];var l=k.getElementsByTagName(STR_BRIGHT)[0].childNodes[0].nodeValue;var c=k.getElementsByTagName(STR_CONTRAST)[0].childNodes[0].nodeValue;var d=k.getElementsByTagName(STR_SATURATION)[0].childNodes[0].nodeValue;var e=k.getElementsByTagName(STR_HUE)[0].childNodes[0].nodeValue;g_bCurChannelHide=k.getElementsByTagName(STR_HIDE_CHANNEL)[0].childNodes[0].nodeValue;SetSliderPos(o,n,parseInt(l,10));SetSliderPos(j,h,parseInt(c,10));SetSliderPos(a,f,parseInt(d,10));SetSliderPos(b,m,parseInt(e,10))}function RecMouseout(){document.getElementById("filmclip_img").src="res/video_clip_normal.jpg"}function SnapPicture(){var c="<request>\r\n";c+='<command name="'+STR_LM_SNAP+'">\r\n';c+="</command>\r\n";c+="</request>\r\n";var e=navigator.userAgent.toLowerCase();var b=navigator.platform.toLowerCase();var h=false;if(e.indexOf("macintosh")!=-1||e.indexOf("mac os x 10")!=-1||b.indexOf("macintel")!=-1){h=true}if(h){var a=WebClient.ExcuteLocalCmd(c);var f;f=FormatToXmlDOM(a);f.async=false;var g=f.documentElement.getElementsByTagName("command");var d=g[0].childNodes[0];if(d.childNodes[0].nodeValue=="0"){window.alert(str_local_snap_failed)}}else{WebClient.ExcuteLocalCmd(c)}}function VideoClip(){var b="<request>\r\n";b+='<command name="'+STR_LM_RECORD+'">\r\n';b+="</command>\r\n";b+="</request>\r\n";var a=WebClient.ExcuteLocalCmd(b);var d;d=FormatToXmlDOM(a);d.async=false;var e=d.documentElement.getElementsByTagName("command");var c=e[0].childNodes[0];if(c.childNodes[0].nodeValue=="0"){window.alert(str_local_record_failed)}}function PlayClip(){var b="<request>\r\n";b+='<command name="'+STR_LM_LPB+'">\r\n';b+="</command>\r\n";b+="</request>\r\n";var a=WebClient.ExcuteLocalCmd(b)}function GetCurSelChannel(){var a="<request>\r\n";a+='<command name="'+STR_LM_GET_LIVE_CHANNEL+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";var c=WebClient.ExcuteLocalCmd(a);if(c!=""){if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(c);g_xmlDoc.async=false;var d=g_xmlDoc.documentElement.getElementsByTagName("command");if((d[0].childNodes.length!=0)&&(d[0].getElementsByTagName("channel")[0].childNodes.length!=0)){if(g_liveSelChannel!=parseInt(d[0].getElementsByTagName("channel")[0].childNodes[0].nodeValue,10)){g_liveSelChannel=parseInt(d[0].getElementsByTagName("channel")[0].childNodes[0].nodeValue,10);var f=document.getElementById("preset_list_live");var b=document.getElementById("cruise_list_live");f.length=0;b.length=0;var e=g_ptzPresetList[g_liveSelChannel];if(g_ptzPresetList[g_liveSelChannel]&&g_ptzCruiseList[g_liveSelChannel]){GenSelectListEx(f,g_ptzPresetList[g_liveSelChannel]);GenSelectListEx(b,g_ptzCruiseList[g_liveSelChannel])}GetVideoColor();FreshPtzState();FreshPtzBrushLampState()}}}}function GetLiveInfo(){var q="<request>\r\n";q+='<command name="'+STR_LM_GET_LIVE_INFO+'">\r\n';q+="</command>\r\n";q+="</request>\r\n";var n=/msie/i.test(navigator.userAgent);var e=WebClient.ExcuteLocalCmd(q);if(e!=""){if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;var c=g_xmlDoc.documentElement.getElementsByTagName("command");if((c[0].childNodes.length!=0)&&(c[0].getElementsByTagName(STR_CLIENT_LIVE_TIME)[0].childNodes.length!=0)){var l=c[0].getElementsByTagName(STR_CLIENT_LIVE_TIME)[0];var h=c[0].getElementsByTagName(STR_MASTER_STREAM_CH)[0];var o=c[0].getElementsByTagName(STR_SECOND_STREAM_CH)[0];var a=c[0].getElementsByTagName(STR_CLIENT_RECORD_CH)[0];l=l.childNodes[0].nodeValue;h=parseInt(h.childNodes[0].nodeValue,16);o=parseInt(o.childNodes[0].nodeValue,16);a=parseInt(a.childNodes[0].nodeValue,16);var g=document.getElementById("first_stream_table").rows;for(var j=0;j<g.length;j++){var p=document.getElementById("first_stream_table").rows[j].cells;for(var m=0;m<p.length;m++){p[m].style.backgroundColor="";p[m].style.color=live_status_color;if(h&(1<<(p.length*j+m))){p[m].style.backgroundColor=live_master_bgcolor;p[m].style.color=live_status_onfocus_color}if(o&(1<<(p.length*j+m))){p[m].style.backgroundColor=live_sub_bgcolor;p[m].style.color=live_status_onfocus_color}}}var d=document.getElementById("web_rec_table").rows;for(var j=0;j<g.length;j++){var f=document.getElementById("web_rec_table").rows[j].cells;for(var m=0;m<p.length;m++){f[m].style.backgroundColor="";f[m].style.color=live_status_color;if(a&(1<<(p.length*j+m))){f[m].style.backgroundColor=live_local_rec_bgcolor;f[m].style.color=live_status_onfocus_color}}}var k=new Date();if(parseInt(l.substring(0,4),10)<k.getFullYear()){l=k.getFullYear()+"-"+(k.getMonth()+1)+"-"+k.getDate()+" "+k.getHours()+":"+k.getMinutes()+":"+k.getSeconds()}var b=document.getElementById("div_live_time");if(n){b.innerText=l}else{b.textContent=l}}}}function OnTimer(){if(g_mainMenuItem==0&&!g_unload){var a=document.getElementById("div_live3");if(a.style.display=="none"){GetCurSelChannel()}GetLiveInfo();g_queryHandle=setTimeout("OnTimer()",1000)}else{clearTimeout(g_queryHandle)}}function liveNavCtrl(c){for(var b=1;b<4;b++){document.getElementById("div_live"+b).style.display="none"}objId=document.getElementById("div_"+c.id);if(objId.style.display==""){objId.style.display="none"}else{objId.style.display=""}if(c.id=="live1"){GetVideoColor()}if(document.getElementById("div_live").offsetHeight>0){var a=document.getElementById("div_live").offsetHeight-5;document.getElementById("div_ocx").style.height="";var d=/msie/i.test(navigator.userAgent);if(d){document.getElementById("div_ocx").style.height="595px";document.getElementById("div_live").style.height="600px"}else{document.getElementById("div_live1").style.height="470px";document.getElementById("div_ocx").style.height="635px";document.getElementById("div_live").style.height="640px"}}}function OnTalk(){if(!(g_authority.authority&1024)){window.alert(str_no_auth);return false}if(g_bTalking){return}var b="<request>\r\n";b+='<command name="'+STR_LM_START_TALK+'">\r\n';b+="</command>\r\n";b+="</request>\r\n";strReply=WebClient.ExcuteLocalCmd(b);if(strReply==""){return}var c;c=FormatToXmlDOM(strReply);c.async=false;var a=c.documentElement.getElementsByTagName("command");if((a.length>0)&&(a[0].getAttribute("name")==STR_LM_START_TALK_SUCC)){g_bTalking=true;document.getElementById("start_talk").style.display="none";document.getElementById("stop_talk").style.display=""}delete c}function OnStopTalk(){if(!g_bTalking){return}var a="<request>\r\n";a+='<command name="'+STR_LM_STOP_TALK+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";WebClient.ExcuteLocalCmd(a);g_bTalking=false;document.getElementById("start_talk").style.display="";document.getElementById("stop_talk").style.display="none"}function RemoteManualRec(){var d=CreateReqManualRecXml();var b=WebClient.ExcuteCmd(d);if(b!=""){var a;a=FormatToXmlDOM(b);a.async=false;var c=talkXmlDoc.documentElement.getElementsByTagName("command");if((c.length>0)&&(c[0].getAttribute("name")==STR_REPLY_NO_AUTH)){window.alert(str_no_auth)}}};
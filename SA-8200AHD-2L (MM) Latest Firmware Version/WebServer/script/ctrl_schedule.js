var g_curIndexList=null;var g_schuduleHTML="";var g_bStartDraw=false;var g_bEraseMode=false;var g_curScheduleDiv=0;var g_startSelDiv=0;var g_CurSchePage_index=0;var g_divcolor_schedule=new Array(new DivColorArrayFun(),new DivColorArrayFun(),new DivColorArrayFun(),new DivColorArrayFun(),new DivColorArrayFun(),new DivColorArrayFun(),new DivColorArrayFun());function OnSetDrawMode(c){g_bEraseMode=c;var a=document.getElementById("img_sch_draw");var b=document.getElementById("img_sch_erase");if(c){a.src="res/draw1.png";b.src="res/erase2.png"}else{a.src="res/draw2.png";b.src="res/erase1.png"}}function OnDocumentMouseMove(){if(g_bStartDraw){return false}}function OnStartSchedule(e){var f=/msie/i.test(navigator.userAgent);var c=document.getElementById("schedule_time_tip");g_bStartDraw=true;g_startSelDiv=e;if(f){g_curScheduleDiv=e.parentElement}else{g_curScheduleDiv=e.parentNode}for(j=0;j<7;j++){g_divcolor_schedule[g_CurSchePage_index].schedulearray[j].Active=false}for(i=0;i<7;i++){if(g_curScheduleDiv.id==g_divcolor_schedule[g_CurSchePage_index].schedulearray[i].Divid){g_divcolor_schedule[g_CurSchePage_index].schedulearray[i].Active=true;break}}var d=g_curScheduleDiv.getElementsByTagName("div");for(i=0;i<d.length;i++){d[i].style.cursor="text";if(d[i]==e){var b=AlignTime(Math.floor(i/4))+":"+AlignTime((i%4)*15)+":00";var a=AlignTime(Math.floor((i+1)/4))+":"+AlignTime(((i+1)%4)*15)+":00";if(f){c.innerText=b+" - "+a}else{c.textContent=b+" - "+a}}}c.style.display="";document.onmousemove=OnDocumentMouseMove;document.onmouseup=OnStopSchedule}function OnStopSchedule(){var d=/msie/i.test(navigator.userAgent);var b=document.getElementById("schedule_time_tip");if(g_bStartDraw){g_bStartDraw=false;var c=g_curScheduleDiv.getElementsByTagName("div");for(i=0;i<c.length;i++){c[i].style.cursor="auto"}b.style.display="none";if(d){b.innerText=""}else{b.textContent=""}var a=0;for(a=0;a<7;a++){if(g_divcolor_schedule[g_CurSchePage_index].schedulearray[a].Active==true){break}}for(i=0;i<c.length;i++){if(g_divcolor_schedule[g_CurSchePage_index].schedulearray[a].subdivclorarray[i]=="#a0a0ff"){if(g_bEraseMode){c[i].style.backgroundColor="#e0e0e0";g_divcolor_schedule[g_CurSchePage_index].schedulearray[a].subdivclorarray[i]="#e0e0e0"}else{c[i].style.backgroundColor="blue";g_divcolor_schedule[g_CurSchePage_index].schedulearray[a].subdivclorarray[i]="blue"}}}g_curScheduleDiv=0;g_startSelDiv=0}}function OnDragging(g){var h=/msie/i.test(navigator.userAgent);if(!g_bStartDraw){return}if(h){if(g_curScheduleDiv!=g.parentElement){return}}else{if(g_curScheduleDiv!=g.parentNode){return}}g_bChange=true;var b=0;for(b=0;b<7;b++){if(g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].Active==true){break}}var d="";var a="";var e=0;if(g_bEraseMode){var f=g_curScheduleDiv.getElementsByTagName("div");for(i=0;i<f.length;i++){if((f[i]==g)||(f[i]==g_startSelDiv)){if(d==""){d=AlignTime(Math.floor(i/4))+":"+AlignTime((i%4)*15)+":00"}else{a=AlignTime(Math.floor((i+1)/4))+":"+AlignTime(((i+1)%4)*15)+":00"}e+=1}if(e&&(g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]!="#e0e0e0")){f[i].style.backgroundColor="#a0a0ff";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="#a0a0ff"}else{if(!e&&(g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]!="#e0e0e0")){f[i].style.backgroundColor="blue";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="blue"}}if((e==2)||(g==g_startSelDiv)){a=AlignTime(Math.floor((i+1)/4))+":"+AlignTime(((i+1)%4)*15)+":00";e=0}if(f[i]==g){}}}else{var f=g_curScheduleDiv.getElementsByTagName("div");for(i=0;i<f.length;i++){if((f[i]==g)||(f[i]==g_startSelDiv)){if(d==""){d=AlignTime(Math.floor(i/4))+":"+AlignTime((i%4)*15)+":00"}else{a=AlignTime(Math.floor((i+1)/4))+":"+AlignTime(((i+1)%4)*15)+":00"}e+=1}if(e&&(g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]!="blue")){f[i].style.backgroundColor="#a0a0ff";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="#a0a0ff"}else{if(!e&&(g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]!="blue")){f[i].style.backgroundColor="#e0e0e0";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="#e0e0e0"}}if((e==2)||((g==g_startSelDiv)&&e)){a=AlignTime(Math.floor((i+1)/4))+":"+AlignTime(((i+1)%4)*15)+":00";e=0}if(f[i]==g){}}}var h=/msie/i.test(navigator.userAgent);var c=document.getElementById("schedule_time_tip");if(h){c.innerText=d+" - "+a}else{c.textContent=d+" - "+a}}function DivColorFun(b){this.Divid=b;this.Active=false;this.subdivclorarray=new Array();for(var a=0;a<96;a++){this.subdivclorarray[a]="#e0e0e0"}}function DivColorArrayFun(){this.CurSchedulePage=false;this.schedulearray=new Array(new DivColorFun("name_schedule_div0"),new DivColorFun("name_schedule_div1"),new DivColorFun("name_schedule_div2"),new DivColorFun("name_schedule_div3"),new DivColorFun("name_schedule_div4"),new DivColorFun("name_schedule_div5"),new DivColorFun("name_schedule_div6"))}function OnGenSchedule(g,n,m){var a=0;var e=0;var h=0;var d="";var b="";g_schuduleHTML="";a=document.createElement("div");a.style.cssText="left:0px;top:0px;border:solid 1px;height:15px;width:63px;position:absolute;text-align:center";a.innerHTML=n;d+=a.outerHTML;if(g_schuduleHTML==""){e=document.createElement("div");e.style.cssText="left:65px;top:0px;width:672px;height:16px;position:absolute";var k=document.createElement("div");b="";for(var f=0;f<672;f+=112){k.style.cssText="width:112px;height:16px;top:0px;position:absolute;z-index:2;border-right:solid 1px;border-top:solid 1px;text-align:left;";k.style.left=f+"px";k.innerHTML="&nbsp;"+AlignTime(f/28)+":00";b+=k.outerHTML}e.innerHTML=b;g_schuduleHTML+=e.outerHTML;var l="";l+="<div id='"+m+"' style='left:64px;top:16px;width:672px;height:20px;position:absolute;border:solid 1px'>";for(var f=0;f<672;f+=7){l+="<div style='left:"+f+"px;top:0px;width:7px;height:20px;position:absolute;background-color:#e0e0e0;z-index:1' onmouseover = 'OnDragging(this)' onmousedown = 'OnStartSchedule(this)'>";l+="</div>"}l+="</div>";g_schuduleHTML+=l}var c=document.createElement("div");c.style.cssText="left:0px;top:16px;border:solid 1px;height:20px;width:63px;position:absolute;text-align:center;background-color:#CCBBFF;display:none;";c.innerHTML="";d+=c.outerHTML;d+=g_schuduleHTML;g.innerHTML=d}function SetScheduleData(c,d,b){var a=document.getElementById(c).childNodes[3].getElementsByTagName("div");for(i=0;i<d.length;i++){if(d.charAt(i)=="1"){a[i].style.backgroundColor="blue";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="blue"}else{a[i].style.backgroundColor="#e0e0e0";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="#e0e0e0"}}}function GetScheduleData(a){var b="";for(i=0;i<96;i++){if(g_divcolor_schedule[g_CurSchePage_index].schedulearray[a].subdivclorarray[i]=="blue"){b+="1"}else{b+="0"}}return b}function ClearSch(c,b){bg_div_obj=document.getElementsByName(c)[0];var a=bg_div_obj.childNodes[3].getElementsByTagName("div");var a=document.getElementById(c).childNodes[3].getElementsByTagName("div");for(i=0;i<96;i++){a[i].style.backgroundColor="#e0e0e0";g_divcolor_schedule[g_CurSchePage_index].schedulearray[b].subdivclorarray[i]="#e0e0e0"}}function OnchangeChannel(b){var c=document.getElementById("cp_config_schedule");var a=document.getElementById("schChannelIndex");GenCpList(c,parseInt(a.value,10),g_curIndexList);UpdateSchedule(g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),false,g_curSchChannel,g_curSchType);g_curSchChannel=b.value;UpdateSchedule(g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),true,g_curSchChannel,g_curSchType)}function GenSchedulePage(){var a=document.getElementById("schChannelIndex");var h=document.getElementById("cp_config_schedule");var k=document.getElementById("schedule_div0");var g=document.getElementById("schedule_div1");var f=document.getElementById("schedule_div2");var e=document.getElementById("schedule_div3");var d=document.getElementById("schedule_div4");var c=document.getElementById("schedule_div5");var b=document.getElementById("schedule_div6");GenSelectListEx(a,g_curIndexList);GenCpList(h,parseInt(a.value,10),g_curIndexList);OnGenSchedule(k,calendar_week[0],"name_schedule_div0");OnGenSchedule(g,calendar_week[1],"name_schedule_div1");OnGenSchedule(f,calendar_week[2],"name_schedule_div2");OnGenSchedule(e,calendar_week[3],"name_schedule_div3");OnGenSchedule(d,calendar_week[4],"name_schedule_div4");OnGenSchedule(c,calendar_week[5],"name_schedule_div5");OnGenSchedule(b,calendar_week[6],"name_schedule_div6")};
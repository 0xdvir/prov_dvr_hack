var g_uploadMaxChnn=0;var g_ftp_chnn=null;function GenFTPCheckGroup(b,g,d,l){var e=0;var o=0;var n=4;var c=20;if(l!=null){n=l}var f=(b.rows.length==1);var h="";var q="";if(f){h=b.rows[0].cells[1].className;q=b.rows[0].cells[1].cssText;b.deleteRow(b.rows[0])}while(b.rows.length>0){b.deleteRow(b.rows[0])}var p=Math.ceil(g.length/n);var a=0;for(i=0;i<p;i++){var m=b.insertRow(i);m.style.cssText="text-align:left;";if(g.length>1){a=1;var k=m.insertCell(0);k.style.cssText="border-right:solid 1px #000;";k.innerHTML="<input type='checkbox' style='width:20px;' onclick='var "+b.id+' = document.getElementById("'+b.id+'");CheckGroup('+b.id+","+i+");OnUploadChnn(this);'/>"}for(j=a;(j-a<n)&&((j-a+i*n)<g.length);j++){k=m.insertCell(j);k.className=h;k.cssText=q;k.innerHTML="<input type='checkbox' name='"+d+"'value = '"+g[j+i*n-a].optionValue+"' style='width:"+c+"px;' onclick='var "+b.id+' = document.getElementById("'+b.id+'");CheckItem('+b.id+","+i+");OnUploadChnn(this);'/>"+(j+1-a+(i*n))}}}function OnLoadCfgFtp(){ApplyXmlLang("cfg_net_ftp.xml");var b=document.getElementById("net_ftp_upload_channel");GenFTPCheckGroup(b,g_channelList,STR_FTP_UPLOAD_CHANNEL+"_ctrl",4);var c=CreateConfigReqXml(net_ftp_config_array);var a=WebClient.ExcuteCmd(c);if(a==""){return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);g_xmlDoc.async=false;UpdateFtpValues(true);Align()}function OnUploadChnn(e){var a=document.getElementById("net_ftp_upload_channel");var d=a.rows;var c=0;var b=new Array();for(row=0;row<d.length;row++){b[row]=new Array();for(col=1;col<d[row].cells.length;col++){if(d[row].cells[col].childNodes[0].checked){c++;b[row][col]=true}else{b[row][col]=false}}}if(c<=g_uploadMaxChnn){g_ftp_chnn=b;g_bChange=true}else{for(row=0;row<d.length;row++){d[row].cells[0].childNodes[0].checked=true;for(col=1;col<d[row].cells.length;col++){d[row].cells[col].childNodes[0].checked=g_ftp_chnn[row][col];if(d[row].cells[0].childNodes[0].checked&&!g_ftp_chnn[row][col]){d[row].cells[0].childNodes[0].checked=false}}}alert(str_select_too_much_channel)}}function LoadDefaultFtpCfg(){if(GetDefaultCfg(net_ftp_config_array)){UpdateFtpValues(true);Align();g_bChange=true}}function UpdateFtpValues(v){var q=document.getElementById("net_ftp_enable");var r=document.getElementById("net_ftp_address");var h=document.getElementById("net_ftp_port");var c=document.getElementById("net_ftp_anonymous");var b=document.getElementById("net_ftp_username");var m=document.getElementById("net_ftp_pwd");var g=document.getElementById("net_ftp_upload_size");var a=document.getElementById("net_ftp_upload_channel");var o=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");var p=/msie/i.test(navigator.userAgent);if(p){for(var u=0;u<o.length;u++){var k=o[u].getAttribute("name");if(k==STR_FTP_INFO){var d=o[u].childNodes[0].nodeValue.split("+");if(v){q.checked=(d[0]=="1");g.value=parseInt(d[1],10);g_uploadMaxChnn=parseInt(d[2],10);h.value=parseInt(d[3],10);c.checked=(d[4]=="1");r.value=d[5];b.value=d[6];m.value=d[7];var e=document.getElementsByName(STR_FTP_UPLOAD_CHANNEL+"_ctrl");var l=a.rows;for(s=0;s<e.length;s++){if(s%4==0){l[s/4].cells[0].childNodes[0].checked=true}var f=parseInt(e[s].value,10);if(d[8].charAt(f)=="1"){e[s].checked=true}else{e[s].checked=false;if(l[s/4].cells[0].childNodes[0].checked){l[s/4].cells[0].childNodes[0].checked=false}}}g_ftp_chnn=new Array();for(row=0;row<l.length;row++){g_ftp_chnn[row]=new Array();for(col=1;col<l[row].cells.length;col++){if(l[row].cells[col].childNodes[0].checked){g_ftp_chnn[row][col]=true}else{g_ftp_chnn[row][col]=false}}}}else{if(q.checked){d[0]="1"}else{d[0]="0"}if(g.value<32){g.value=32}if(g.value>64){g.value=64}d[1]=""+g.value;d[2]=""+g_uploadMaxChnn;d[3]=""+h.value;if(c.checked){d[4]="1"}else{d[4]="0"}d[5]=""+r.value.size()+":"+r.value;d[6]=""+b.value.size()+":"+b.value;d[7]=""+m.value.size()+":"+m.value;var n=new Array(36);for(s=0;s<n.length;s++){n[s]="0"}var e=document.getElementsByName(STR_FTP_UPLOAD_CHANNEL+"_ctrl");for(s=0;s<e.length;s++){var f=parseInt(e[s].value,10);if(e[s].checked){n[f]="1"}}d[8]=n.join("");o[u].firstChild.nodeValue=d.join("+")}}}}else{for(var u=0;u<o.length;u++){var k=o[u].getAttribute("name");if(k==STR_FTP_INFO){var d=o[u].childNodes[0].nodeValue.split("+");if(v){q.checked=(d[0]=="1");g.value=parseInt(d[1],10);g_uploadMaxChnn=parseInt(d[2],10);h.value=parseInt(d[3],10);c.checked=(d[4]=="1");r.value=d[5];b.value=d[6];m.value=d[7];var e=document.getElementsByName(STR_FTP_UPLOAD_CHANNEL+"_ctrl");var l=a.rows;for(s=0;s<e.length;s++){var f=parseInt(e[s].value,10);if(d[8].charAt(f)=="1"){e[s].checked=true}else{e[s].checked=false}}UpdateCheckItems(a);g_ftp_chnn=new Array();for(var u=0;u<a.rows.length;u++){g_ftp_chnn[u]=new Array();var t=a.rows[u].getElementsByTagName("input");if(t.length>1){for(var s=1;s<a.rows[u].cells.length;s++){if(!t[s].checked){g_ftp_chnn[u][s]=false}else{g_ftp_chnn[u][s]=true}}}}}else{if(q.checked){d[0]="1"}else{d[0]="0"}if(g.value<32){g.value=32}if(g.value>64){g.value=64}d[1]=""+g.value;d[2]=""+g_uploadMaxChnn;d[3]=""+h.value;if(c.checked){d[4]="1"}else{d[4]="0"}d[5]=""+r.value.size()+":"+r.value;d[6]=""+b.value.size()+":"+b.value;d[7]=""+m.value.size()+":"+m.value;var n=new Array(36);for(s=0;s<n.length;s++){n[s]="0"}var e=document.getElementsByName(STR_FTP_UPLOAD_CHANNEL+"_ctrl");for(s=0;s<e.length;s++){var f=parseInt(e[s].value,10);if(e[s].checked){n[f]="1"}}d[8]=n.join("");o[u].firstChild.nodeValue=d.join("+")}}}}};
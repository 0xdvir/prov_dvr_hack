var cfg_manual_alarm_header=new Array(str_no,str_alarmout_name,str_address,str_trigger);var g_diskInfoArray=new Array();var g_diskTypeName=new Array("IDE","SATA","USB","REMDISK","ESATA","SD","CD/DVD");var g_diskStatusName=new Array(str_normal,str_notformatted,str_nocd,str_mounted,str_notmounted);var g_diskProperty=new Array(new CSelectOptionInfo(str_readwrite,0),new CSelectOptionInfo(str_readonly,1),new CSelectOptionInfo(str_redundancy,2));var g_diskOwnerName=new Array(str_this,str_other);var g_curSelDisk=-1;var g_formatThread=-1;var g_updateThread=-1;var g_updatedoc=null;var g_formatDiskNum=0;var g_formatFinished=0;function rgbToHex(a){if(a.indexOf("rgb")!=-1){a=a.replace("rgb(","");a=a.replace(")","");a=a.split(",");r=parseInt(a[0]);g=parseInt(a[1]);b=parseInt(a[2]);r=r.toString(16);if(r.length==1){r="0"+r}g=g.toString(16);if(g.length==1){g="0"+g}b=b.toString(16);if(b.length==1){b="0"+b}return("#"+r+g+b).toUpperCase()}else{return a}}function DiskInfo(f,j,e,a,c,h,d){this.diskTypeGroup=f;this.diskType=j;this.diskSize=e;this.diskFree=a;this.diskStatus=c;this.diskProperty=h;this.diskOwner=d}function enabeProperty(){var f=document.getElementsByName("enable_property");var e=document.getElementsByName("disk_property");var a=document.getElementById("diskm_apply_btn");var d=document.getElementById("diskm_format_btn");var c=false;for(i=0;i<g_diskInfoArray.length;i++){if(g_diskInfoArray[i].diskStatus==0){e[i].disabled=!g_supportFunctions.IsSupportDiskMan()||!f[i].checked}if(g_diskInfoArray[i].diskProperty!=e[i].value){a.disabled=false}if(c==false&&f[i].checked){c=true}}if(!c){a.disabled=true;d.disabled=true}else{d.disabled=false}if(a.disabled){a.style.color=btn_text_disabled_color}else{a.style.color=btn_text_normal_color}if(d.disabled){d.style.color=btn_text_disabled_color}else{d.style.color=btn_text_normal_color}}function GotoAdvancePage(){var a=document.getElementById("div_main_menu");var c=document.getElementById("div_advance_body");if(g_mainMenuItem==3){HintSave(-1)}g_mainMenuItem=4;g_lastNav=null;selected(g_mainMenuItem);HideDIVs();a.style.display="";c.style.display="";g_lastNav="";g_lastNavSec="";g_xmlhttp.open("get","body_html/body_advance.html",false);SafeHttpSend(g_xmlhttp,null);OnReceiveAdvance()}function OnReceiveAdvance(){var n=document.getElementById("div_advance_body");if(g_xmlhttp.readyState!=4){return}n.innerHTML=g_xmlhttp.responseText;var c=document.getElementsByName("disk_property");for(var j=0;j<c.length;j++){c[j].style.width="100%";c[j].style.display="none"}var h=document.getElementById("manualAlarm_nav");var k=document.getElementById("div_advance_nav");var m=document.getElementById("diskmanager_nav");if(g_supportFunctions.IsNotSupportAlarm()){searchNavS(m)}else{searchNavS(h)}ApplyXmlLang("advance.xml");EdgeCtrl(k,78);var f=document.getElementById("diskm_apply_btn");var o=document.getElementById("diskm_format_btn");if(!g_supportFunctions.IsSupportDiskMan()){f.style.display="none";o.style.display="none"}var e=/msie/i.test(navigator.userAgent);if(!e){var l=n.offsetHeight+40;document.getElementById("work_area").style.height=l+"px"}if(g_supportFunctions.IsNotSupportAlarm()){var a=h.parentNode;var d=a.parentNode;d.removeChild(a);GotoDiskManager()}else{GotoManualAlarm()}}function UpdateManualAlarm(e){var d=document.getElementById("id_manual_alarm");var h=document.getElementById("manual_alarm_all");var j=new Array();var k="";for(i=0;i<e.length;i++){if(STR_ALARMOUT_NAME==e[i].attributes.getNamedItem("name").nodeValue){var c=e[i].attributes.getNamedItem("index").nodeValue;var a="";if(e[i].childNodes.length){a=e[i].childNodes[0].nodeValue.toString()}j[parseInt(c)]=a}if(STR_NETWORK==e[i].attributes.getNamedItem("name").nodeValue){var f=e[i].childNodes[0].nodeValue.toString().split("+");k=f[1]}}for(i=0;i<g_alarmoutList.length;i++){d.rows[i+1].cells[1].innerHTML=j[i];d.rows[i+1].cells[2].innerHTML=k}h.checked=false}function GotoManualAlarm(){var k=document.getElementById("advance_dismanager_div");var j=document.getElementById("advance_upgrade_div");var e=document.getElementById("advance_manual_alarm_div");var d=document.getElementById("advanced_reset_div");k.style.display="none";j.style.display="none";d.style.display="none";e.style.display="";var c=document.getElementById("id_manual_alarm");CreateListManualAlarm(c,4,cfg_manual_alarm_header,g_alarmoutList.length);var f=CreateConfigReqXml(manual_alarm_array);var a=WebClient.ExcuteCmd(f);if(a==""){return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);g_xmlDoc.async=false;var h=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateManualAlarm(h)}function OnClickAlarm(){var a=g_xmlDoc.documentElement.getElementsByTagName("command");var c=a[0].childNodes;var k=document.getElementsByName("manual_alarm_trigger");var d=document.getElementById("manual_alarm_all");var f="";var j=/msie/i.test(navigator.userAgent);f="<request>\r\n";f+='<command name="'+STR_MANUAL_ALARM+'">\r\n';var h=new Array();for(i=0;i<g_alarmoutList.length;i++){if(d.checked||k[i].checked){h[i]="1"}else{h[i]="0"}}f+=h.join("+");f+="</command>\r\n";f+="</request>\r\n";var e=WebClient.ExcuteCmd(f);if(e==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false}function OnClickClear(){var a=g_xmlDoc.documentElement.childNodes;var c=a[0].childNodes;var j=document.getElementsByName("manual_alarm_trigger");var e="";var h=/msie/i.test(navigator.userAgent);e="<request>\r\n";e+='<command name="'+STR_MANUAL_ALARM_CLEAR+'">\r\n';var f=new Array();for(i=0;i<g_alarmoutList.length;i++){if(j[i].checked){f[i]="1"}else{f[i]="0"}}e+=f.join("+");e+="</command>\r\n";e+="</request>\r\n";var d=WebClient.ExcuteCmd(e);if(d==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(d);g_xmlDoc.async=false}function checkAll(){var a=document.getElementsByName("manual_alarm_trigger");var c=document.getElementById("manual_alarm_all");for(i=0;i<a.length;i++){if(!a[i].checked){c.checked=false;return}}c.checked=true}function CreateListManualAlarm(j,a,c,l){var e=/msie/i.test(navigator.userAgent);var k=j.outerHTML.toLowerCase();var d=k.indexOf("<tbody>");k=k.substr(0,d+7);k+="<tr class = 'table_head_bgcolor'>";for(var f=0;f<a;f++){k+='<td style = "text-align:center">'+c[f]+"</td>"}k+="</tr>";for(var f=1;f<l+1;f++){if(e){k+="<tr>";k+='<td style = "text-align:center;width:50px;">'+f+"</td>";k+='<td style = "text-align:center;width:300px;"></td>';k+='<td style = "text-align:center;width:300px;"></td>';k+='<td><input type = "checkbox" style = "width:50px" name = "manual_alarm_trigger" onclick = \'checkAll()\'/></td>';k+="</tr>"}else{k+="<tr>";k+='<td style = "text-align:center;width:50px;">'+f+"</td>";k+='<td style = "text-align:center;width:300px;"></td>';k+='<td style = "text-align:center;width:300px;"></td>';k+='<td><input type = "checkbox" style = "width:50px" name = "manual_alarm_trigger" onclick = \'checkAll()\'/></td>';k+="</tr>"}}k+="</tbody></table>";if(e){var h=j.parentElement}else{var h=j.parentNode}h.innerHTML=k;j=h.childNodes[0]}function OnClickAll(){var a=document.getElementsByName("manual_alarm_trigger");var c=document.getElementById("manual_alarm_all");for(i=0;i<a.length;i++){a[i].checked=c.checked}}function GotoDiskManager(){var f=document.getElementById("advance_dismanager_div");var a=document.getElementById("advance_upgrade_div");var l=document.getElementById("advanced_reset_div");var p=document.getElementById("diskm_format_btn");var h=document.getElementById("advance_diskm_table");var j=document.getElementById("diskm_refresh_btn");var c=document.getElementById("diskm_apply_btn");var n=document.getElementById("advance_manual_alarm_div");var k=/msie/i.test(navigator.userAgent);var m=new Array(STR_SUPPORT_REC_REDUNDANCY);var o=CreateConfigReqXml(m);var e=WebClient.ExcuteCmd(o);OnConstItemProc(e);f.style.display="";a.style.display="none";n.style.display="none";l.style.display="none";p.disabled=true;if(!g_supportRecRedundancy){g_diskProperty.splice(2,1)}for(var d=1;d<h.rows.length;d++){h.rows[d].onmouseover=function(){if((g_curSelDisk==-1)||(h.rows[g_curSelDisk+1]!=this)){if(k){if(this.cells[1].innerText!=" "){this.style.backgroundColor=advanced_selected_bg;this.style.color=advanced_selected_color}}else{if(this.cells[1].textContent!=" "){this.style.backgroundColor=advanced_selected_bg;this.style.color=advanced_selected_color}}}};h.rows[d].onmouseout=function(){if(rgbToHex(this.style.backgroundColor).toUpperCase()==advanced_selected_bg){this.style.backgroundColor="";this.style.color=""}}}if(g_authority.authority&4096){GetDiskInfo()}else{j.disabled=true;c.disabled=true;p.disabled=true;window.alert(str_no_auth)}if(c.disabled){c.style.color=btn_text_disabled_color}else{c.style.color=btn_text_normal_color}if(p.disabled){p.style.color=btn_text_disabled_color}else{p.style.color=btn_text_normal_color}if(j.disabled){j.style.color=btn_text_disabled_color}else{j.style.color=btn_text_normal_color}}function GotoUpgrade(){var e=document.getElementById("advance_dismanager_div");var d=document.getElementById("advance_upgrade_div");var c=document.getElementById("advance_manual_alarm_div");var a=document.getElementById("advanced_reset_div");e.style.display="none";d.style.display="";c.style.display="none";if((g_langName=="chinese_cht")||(g_langName=="japanese")){a.style.display=""}}function OnChangeDiskProperty(){var c=document.getElementById("diskm_apply_btn");var a=document.getElementsByName("disk_property");c.disabled=true;for(var d=0;d<g_diskInfoArray.length;d++){if(g_diskInfoArray[d].diskProperty!=a[d].value){c.disabled=false;break}}if(c.disabled){c.style.color=btn_text_disabled_color}else{c.style.color=btn_text_normal_color}}function GetDiskInfo(){g_diskInfoArray=new Array();var p="<request>\r\n";p+='<command name="'+STR_DISK_MAN_START+'">\r\n';p+="</command>\r\n";p+="</request>\r\n";var e=WebClient.ExcuteCmd(p);if(e==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;var o=g_xmlDoc.documentElement.getElementsByTagName("command")[0];if(o.getAttribute("name")==STR_DISK_MAN_RESULT){window.alert(str_someone_format_disk)}else{var d=o.getElementsByTagName("item");for(var k=0;k<d.length;k++){var q=d[k].getElementsByTagName(STR_DISK_TYPE_GROUP)[0].childNodes[0].nodeValue;var c=d[k].getElementsByTagName(STR_DISK_TYPE)[0].childNodes[0].nodeValue;var j=d[k].getElementsByTagName(STR_DISK_SIZE)[0].childNodes[0].nodeValue;var a=d[k].getElementsByTagName(STR_DISK_FREE_SPACE)[0].childNodes[0].nodeValue;var l=d[k].getElementsByTagName(STR_DISK_STATUS)[0].childNodes[0].nodeValue;var f=d[k].getElementsByTagName(STR_DISK_PROPERTY)[0].childNodes[0].nodeValue;var n=d[k].getElementsByTagName(STR_DISK_OWNER)[0].childNodes[0].nodeValue;g_diskInfoArray[k]=new DiskInfo(q,c,j,a,l,f,n)}}DisplayDisk();var m=document.getElementsByName("disk_property");var h=document.getElementsByName("enable_property");for(k=0;k<m.length;k++){h[k].checked=false;m[k].disabled=true}}function DisplayDisk(){var a=document.getElementsByName("disk_property");var d=document.getElementsByName("enable_property");var f=document.getElementById("advance_diskm_table");var c=document.getElementById("diskm_format_btn");var k=/msie/i.test(navigator.userAgent);var j=f.rows;for(var e=0;e<g_diskInfoArray.length;e++){if(k){j[e+1].cells[1].innerText=e+1;j[e+1].cells[2].innerText=g_diskTypeName[g_diskInfoArray[e].diskType];j[e+1].cells[3].innerText=g_diskInfoArray[e].diskSize;j[e+1].cells[4].innerText=g_diskInfoArray[e].diskFree;j[e+1].cells[7].innerText=g_diskOwnerName[g_diskInfoArray[e].diskOwner]}else{j[e+1].cells[1].textContent=e+1;j[e+1].cells[2].textContent=g_diskTypeName[g_diskInfoArray[e].diskType];j[e+1].cells[3].textContent=g_diskInfoArray[e].diskSize;j[e+1].cells[4].textContent=g_diskInfoArray[e].diskFree;j[e+1].cells[7].textContent=g_diskOwnerName[g_diskInfoArray[e].diskOwner]}a[e].style.display="";a[e].disabled=true;if((g_diskInfoArray[e].diskTypeGroup==0)&&(g_diskInfoArray[e].diskOwner==0)){GenSelectListEx(a[e],g_diskProperty);if(k){j[e+1].cells[5].innerText=g_diskStatusName[g_diskInfoArray[e].diskStatus]}else{j[e+1].cells[5].textContent=g_diskStatusName[g_diskInfoArray[e].diskStatus]}a[e].value=g_diskInfoArray[e].diskProperty;if(g_diskInfoArray[e].diskStatus==0){a[e].disabled=!g_supportFunctions.IsSupportDiskMan()}}else{var h=new Array();h[0]=g_diskProperty[0];GenSelectListEx(a[e],h);a[e].value=0;if(g_diskInfoArray[e].diskTypeGroup==1){if(k){j[e+1].cells[5].innerText=g_diskStatusName[0]}else{j[e+1].cells[5].textContent=g_diskStatusName[0]}}else{if(k){j[e+1].cells[5].innerText=g_diskStatusName[g_diskInfoArray[e].diskStatus]}else{j[e+1].cells[5].textContent=g_diskStatusName[g_diskInfoArray[e].diskStatus]}}}}for(e=g_diskInfoArray.length;e<(j.length-1);e++){if(k){j[e+1].cells[1].innerText=" ";j[e+1].cells[2].innerText="";j[e+1].cells[3].innerText="";j[e+1].cells[4].innerText="";j[e+1].cells[5].innerText="";j[e+1].cells[7].innerText=""}else{j[e+1].cells[1].textContent=" ";j[e+1].cells[2].textContent="";j[e+1].cells[3].textContent="";j[e+1].cells[4].textContent="";j[e+1].cells[5].textContent="";j[e+1].cells[7].textContent=""}a[e].style.display="none";d[e].style.display="none"}for(e=1;e<j.length;e++){f.rows[e].style.backgroundColor="";f.rows[e].style.color=""}c.disabled=true}function FormatDisk(){if(!confirm(str_confirm_format_disk)){return}var c=g_xmlDoc.documentElement.getElementsByTagName("command");var d=c[0].getElementsByTagName("item");var j=document.getElementsByName("enable_property");var f="";var h=/msie/i.test(navigator.userAgent);f="<request>\r\n";f+='<command name="'+STR_FORMAT_DISK_START+'">\r\n';g_formatDiskNum=0;for(i=0;i<d.length;i++){if(j[i].checked){g_formatDiskNum++;if(h){f+=d[i].xml}else{var a=serializeXml(d[i]);if(null!=g_oSerializer){delete g_oSerializer;g_oSerializer=null}f+=a}}}g_formatFinished=0;f+="</command>\r\n";f+="</request>\r\n";var e=WebClient.ExcuteCmd(f);if(e==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;c=g_xmlDoc.documentElement.getElementsByTagName("command")[0];if(c.attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth);return}if(c.childNodes[0].nodeValue==STR_SUCCESS){InitProgressBar();StartWaitTip(str_disk_format_wait_tip);g_formatThread=setTimeout("GetFormatPercent()",500)}else{if(c.childNodes[0].nodeValue==STR_DISK_BUSY_PB_BK){window.alert(str_disk_busy_pb_bk)}GetDiskInfo()}}function ApplyDiskSettings(){if(!confirm(str_confirm_disk_settings)){return}var k=g_xmlDoc.documentElement.getElementsByTagName("command");var c=k[0].getElementsByTagName("item");var n="<request>\r\n";n+='<command name="'+STR_DISK_CHANGE_PROPERTY+'">\r\n';var h=/msie/i.test(navigator.userAgent);var a=document.getElementsByName("disk_property");var l=document.getElementsByName("enable_property");var m=0;for(var f=0;f<c.length;f++){if(l[f].checked&&g_diskInfoArray[f].diskProperty!=a[f].value){if(h){c[f].getElementsByTagName(STR_DISK_TEMP)[0].childNodes[0].nodeValue=a[f].value;n+=c[f].xml;m++}else{c[f].getElementsByTagName(STR_DISK_TEMP)[0].childNodes[0].nodeValue=a[f].value;var j=serializeXml(c[f]);if(null!=g_oSerializer){delete g_oSerializer;g_oSerializer=null}n+=j;m++}}}n+="</command>\r\n";n+="</request>\r\n";if(m==0){return}var e=WebClient.ExcuteCmd(n);if(e==""){return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;k=g_xmlDoc.documentElement.getElementsByTagName("command")[0];if(k.attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth);return}if(k.childNodes[0].nodeValue==STR_SUCCESS){window.alert(str_disk_config_succ)}else{if(k.childNodes[0].nodeValue==STR_DISK_FORMATTING){}else{if(k.childNodes[0].nodeValue==STR_DISK_IO_ERROR){window.alert(str_disk_io_error)}else{if(k.childNodes[0].nodeValue==STR_DISK_BUSY_PB_BK){window.alert(str_disk_busy_pb_bk)}else{window.alert(str_disk_config_fail)}}}}var d=document.getElementById("diskm_apply_btn");d.disabled=true;d.style.color=btn_text_disabled_color;GetDiskInfo()}function GetFormatPercent(){var j=/msie/i.test(navigator.userAgent);var k=document.getElementById("disk_unformatted");var m=document.getElementById("disk_formatted");var c=document.getElementById("disk_format_label");var o="<request>\r\n";o+='<command name="'+STR_DISK_FORMAT_PERCENT+'">\r\n';o+="</command>\r\n";o+="</request>\r\n";var e=WebClient.ExcuteCmd(o);if(e==""){DestroyProgressBar();clearTimeout(g_formatThread);return}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;var l=g_xmlDoc.documentElement.getElementsByTagName("command")[0];var a=l.getElementsByTagName(STR_DISK_FORMAT_PROGRESS)[0].childNodes[0].nodeValue;var h=parseInt(a,10);if(a=="101"){StopWaitTip();clearTimeout(g_formatThread);window.alert(str_disk_format_fail);DestroyProgressBar();StopDiskFormat()}else{if(h>=100){g_formatFinished=(h-100)/10+1;if(g_formatDiskNum==g_formatFinished){m.style.width="600px";k.style.width="0px";k.style.display="none";if(j){c.innerText="100%, "+g_formatFinished+"/"+g_formatDiskNum}else{c.textContent="100%, "+g_formatFinished+"/"+g_formatDiskNum}StopWaitTip();clearTimeout(g_formatThread);window.alert(str_disk_format_finish);DestroyProgressBar();StopDiskFormat();GetDiskInfo()}else{if(f>0){m.style.display=""}m.style.width="600px";k.style.width="0px";k.style.display="none";if(j){c.innerText=100+"%, "+g_formatFinished+"/"+g_formatDiskNum}else{c.textContent=100+"%, "+g_formatFinished+"/"+g_formatDiskNum}g_formatThread=setTimeout("GetFormatPercent()",500)}}else{var f=600*parseInt(a,10)/100;k.style.display="";if(f>0){m.style.display=""}m.style.width=f+"px";k.style.width=(600-f)+"px";var d=g_formatFinished+1;if(j){c.innerText=a+"%, "+d+"/"+g_formatDiskNum}else{c.textContent=a+"%, "+d+"/"+g_formatDiskNum}g_formatThread=setTimeout("GetFormatPercent()",500)}}}function StopDiskFormat(){var a="<request>\r\n";a+='<command name="'+STR_FORMAT_DISK_STOP+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";WebClient.ExcuteCmd(a)}function InitProgressBar(){var a=document.getElementById("disk_progress_table");var c=document.getElementById("disk_formatted");var d=document.getElementById("disk_unformatted");a.style.display="";d.style.display="";c.style.display="none"}function InitUpdateProgressBar(){var c=document.getElementById("update_progress_table");var d=document.getElementById("advance_update_label");var a=document.getElementById("updated");c.style.display="";d.style.display="";a.style.display="none"}function DestroyProgressBar(){var a=document.getElementById("disk_progress_table");var c=document.getElementById("disk_formatted");var d=document.getElementById("disk_unformatted");a.style.display="none";c.style.display="none";c.style.width="0px";d.style.width="600px"}function DestroyUpdateProgressBar(){var d=document.getElementById("update_progress_table");var e=document.getElementById("advance_update_label");var a=document.getElementById("updated");var c=document.getElementById("noupdate");d.style.display="none";e.style.display="none";a.style.display="none";a.style.width="0px";c.style.width="600px"}function BrowseFolderUpdate(){var a=document.getElementById("advanced_update_path");a.value=WebClient.BrowseFile(2)}function Update(){var a=document.getElementById("advanced_update_path");var f="<request>\r\n";f+='<command name="'+STR_UPDATE+'">\r\n';f+="</command>\r\n";f+="</request>\r\n";if(a.value==""){window.alert(str_no_update_path);return}var d=window.confirm(str_if_update);if(d==false){return}if(CheckFileLength()){window.alert(str_update_fail_invaid_file);return}else{var e=WebClient.ExcuteCmd(f);if(null!=g_xmlDoc){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(e);g_xmlDoc.async=false;var c=g_xmlDoc.documentElement.getElementsByTagName("command")[0];if(c.childNodes[0].nodeValue==STR_CANNOT_UPDATE){window.alert(str_update_fail)}else{if(c.childNodes[0].nodeValue==STR_FAIL_UPDATING){window.alert(str_fail_updating)}else{if(c.childNodes[0].nodeValue==STR_UPDATE_FAIL_FORMAT_DISK){window.alert(str_update_fail_fomat_disk)}else{if(c.childNodes[0].nodeValue==STR_UPDATE_FAIL_NO_DISK){window.alert(str_update_fail_no_disk)}else{if(c.childNodes[0].nodeValue==STR_UPDATE_FAIL_NO_AUTHORITY){window.alert(str_no_auth)}else{if(c.childNodes[0].nodeValue==STR_CAN_UPDATE){SendUpdateDate()}}}}}}}}function CheckFileLength(){var a=document.getElementById("advanced_update_path");var h="<request>\r\n";h+='<command name="'+STR_CHECK_LENTH+'">\r\n';h+="<"+STR_UPDATE_PATH+">"+a.value+"</"+STR_UPDATE_PATH+">\r\n";h+="</command>\r\n";h+="</request>\r\n";var f=WebClient.ExcuteLocalCmd(h);var d;d=FormatToXmlDOM(f);d.async=false;var e=d.documentElement.getElementsByTagName("command");var c=e[0].getElementsByTagName(STR_CHECK_INFO)[0].childNodes[0].nodeValue;if(c==1){if(null!=d){delete d;d=null}return 1}else{if(null!=d){delete d;d=null}return 0}}function SendUpdateDate(){var a=document.getElementById("advanced_update_path");var d="<request>\r\n";d+='<command name="'+STR_UPDATE_DATA+'">\r\n';d+="<"+STR_UPDATE_PATH+">"+a.value+"</"+STR_UPDATE_PATH+">\r\n";d+="</command>\r\n";d+="</request>\r\n";var c=WebClient.ExcuteLocalCmd(d);InitUpdateProgressBar();StartWaitTipForUpdate(str_update_wait_tip,str_cancel_update_tip);g_updateThread=setTimeout("GetUpdatePercent()",500)}function CancelUpdate(){var a="<request>\r\n";a+='<command name="'+STR_UPDATE_STOP+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";WebClient.ExcuteLocalCmd(a);StopWaitTipForUpdate();DestroyUpdateProgressBar();window.alert(str_cancel_update);clearTimeout(g_updateThread);return}function GetUpdatePercent(){var f=document.getElementById("cancel_update_btn");var o=document.getElementById("advanced_update_btn");var l=document.getElementById("update_progress_table");var j=document.getElementById("updated");var n=document.getElementById("noupdate");var c=document.getElementById("update_label");var k=/msie/i.test(navigator.userAgent);var m="<request>\r\n";m+='<command name="'+STR_LM_UPDATE_PROGRESS+'"></command>\r\n';m+="</request>\r\n";var e=WebClient.ExcuteLocalCmd(m);if(g_updatedoc!=null){delete g_updatedoc;g_updatedoc=null}g_updatedoc=FormatToXmlDOM(e);g_updatedoc.async=false;var d=g_updatedoc.documentElement.getElementsByTagName("command")[0];var a=d.getElementsByTagName(STR_UPDATE_PROGRESS)[0].childNodes[0].nodeValue;a=parseInt(a,10);if(a==99){f.disabled="disabled";f.style.color=btn_text_disabled_color}if(a==101){StopWaitTipForUpdate();clearTimeout(g_updateThread);window.alert(str_update_fail);f.disabled="";f.style.color=btn_text_normal_color;o.disabled="";o.style.color=btn_text_normal_color;DestroyUpdateProgressBar();return}if(a==102){StopWaitTipForUpdate();clearTimeout(g_updateThread);window.alert(str_update_fail_invaid_file);f.disabled="";f.style.color=btn_text_normal_color;o.disabled="";o.style.color=btn_text_normal_color;DestroyUpdateProgressBar();return}if(a==100){StopWaitTipForUpdate();l.style.width="600px";n.style.display="none";if(k){c.innerText="100%"}else{c.textContent="100%"}clearTimeout(g_updateThread);var q="<request>\r\n";q+='<command name="'+STR_SEND_FINISH+'">\r\n';q+="</command>\r\n";q+="</request>\r\n";var h=WebClient.ExcuteCmd(q);DestroyUpdateProgressBar();window.alert(str_update_succ);return}else{var p=600*parseInt(a,10)/100;if(p>0){j.style.display=""}j.style.width=p+"px";n.style.width=(600-p)+"px";if(k){c.innerText=a+"%"}else{c.textContent=a+"%"}g_updateThread=setTimeout("GetUpdatePercent()",500)}}function AdvanceReset(){var a="<request>\r\n";a+='<command name="'+STR_REQUEST_REBOOT+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";WebClient.ExcuteCmd(a)};
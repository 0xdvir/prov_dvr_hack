var cfg_otheralarm_header=new Array(str_ch,str_trigger);var cfg_vloss_ptz_header=new Array(str_ch,str_type,str_no);function OnLoadCfgVlossAlarm(){ApplyXmlLang("cfg_vloss_alarm.xml");var c=document.getElementById("id_vloss_alarm");var b=document.getElementById("vloss_trigger_out");var d=document.getElementById("vloss_snap");var h=document.getElementById("id_vloss_ptz");var f=document.getElementById("vloss_trigger_ptz_label");CreateListVLoss(c,2,cfg_otheralarm_header,g_local_ch_num+g_net_ch_num);GenCheckGroup(b,true,g_alarmoutList,STR_VLOSS_TO_ALARM_OUT+"_ctrl",4,Btrigger);GenCheckGroup(d,true,g_TotalChannelList,STR_VLOSS_TO_SNAP+"_ctrl",4,Btrigger);if(g_alarmoutList.length>1){b.className+=" user_gen_table"}else{b.style.border="0";b.rows[0].cells[0].style.border="0"}if(!g_supportFunctions.IsSupportPTZ()){var h=document.getElementById("id_vloss_ptz");f.parentNode.style.display="none";h.parentNode.parentNode.style.display="none"}if(g_supportFunctions.IsNotSupportAlarm()){document.getElementById("vloss_alarmout_label").style.display="none";document.getElementById("vloss_alarmout_label").parentNode.style.display="none";b.style.display="none";b.parentNode.parentNode.style.display="none"}VlossTriggerPTZ(h,3,cfg_vloss_ptz_header,g_local_ch_num+g_net_ch_num);var e=CreateConfigReqXml(vloss_alarm_config_array);var a=WebClient.ExcuteCmd(e);if(a==""){return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);g_xmlDoc.async=false;var g=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateValues(g,true);AlarmGetCruiseList(g);Align()}function LoadDefaultCfgVlossAlarm(){if(GetDefaultCfg(vloss_alarm_config_array)){onVlossPTZCancel();var b=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateValues(b,true);var a=/msie/i.test(navigator.userAgent);for(i=0;i<b.length;i++){if(b[i].parentNode&&STR_PTZ_CRUISE_INFO==b[i].attributes.getNamedItem("name").nodeValue){b[i].parentNode.removeChild(b[i]);i=0}}g_bChange=true;bTrigger=true}}function CreateListVLoss(g,a,b,j){var d=/msie/i.test(navigator.userAgent);var h=g.outerHTML.toLowerCase();var c=h.indexOf("</tbody>");h=h.substr(0,c);h+="<tr class = 'table_head_bgcolor'>";for(var e=0;e<a;e++){h+='<td style = "text-align:center">'+b[e]+"</td>"}h+="</tr>";for(var e=1;e<j+1;e++){h+="<tr>";h+='<td style = "width:240px;text-align:center">'+e+"</td>";h+='<td align = "center" style = "width:487px;"><input id = "vloss_trigger_btn" type = "button" value = '+set_button+' onclick = "OnDisOrHidVloss('+(e-1)+')"/></td>';h+="</tr>"}h+="</tbody></table>";if(d){var f=g.parentElement}else{var f=g.parentNode}f.innerHTML=h;g=f.childNodes[0]}function VlossTriggerPTZ(g,a,b,j){var d=/msie/i.test(navigator.userAgent);var h=g.outerHTML.toLowerCase();var c=h.indexOf("</tbody>");h=h.substr(0,c);h+="<tr class = 'table_head_bgcolor'>";for(var e=0;e<a;e++){h+='<td style = "text-align:center">'+b[e]+"</td>"}h+="</tr>";for(var e=1;e<j+1;e++){h+="<tr>";h+='<td style = "width:180px;text-align:center">'+e+"</td>";h+='<td><select style = "width:260px" name = "ptz_type" onchange = "onMotionChangePtzType(this,'+e+');bTrigger = true"></select></td>';h+='<td><select style = "width:260px" name = "ptz_number"onchange = "bTrigger = true;"></select></td>';h+="</tr>"}h+="</tbody></table>";if(d){var f=g.parentElement}else{var f=g.parentNode}f.innerHTML=h;g_motionPTZTypeCopy=g_motionPTZType.slice(0);g_motionPTZTypeCopy.splice(g_motionPTZType.length-1,1);for(var e=1;e<j+1;e++){if(e>g_local_ch_num){GenSelectListEx(document.getElementsByName("ptz_type")[e-1],g_motionPTZTypeCopy)}else{GenSelectListEx(document.getElementsByName("ptz_type")[e-1],g_motionPTZType)}if(document.getElementsByName("ptz_type")[e-1].value==2){GenSelectListEx(document.getElementsByName("ptz_number")[e-1],g_cruiseList[e-1])}else{GenSelectListEx(document.getElementsByName("ptz_number")[e-1],g_presetList)}}g=f.childNodes[0]}function OnDisOrHidVloss(g){var a=document.getElementById("div_config_index");var h=document.getElementById("div_vloss_trigger");var b=document.getElementById("other_index_num");var f=document.getElementById("vloss_to_bigview_ctrl");var j=document.getElementById("cp_config_vloss");var c=document.getElementById("vloss_trigger_out");var l=document.getElementById("vloss_snap");var e=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateBooleanTrigger(e,STR_VLOSS_TO_BUZZ,STR_VLOSS_TO_BUZZ+"_ctrl",false);UpdateBooleanTrigger(e,STR_VLOSS_TO_EMAIL,STR_VLOSS_TO_EMAIL+"_ctrl",false);UpdateAlarmTrigger(e,STR_VLOSS_TO_ALARM_OUT,STR_VLOSS_TO_ALARM_OUT+"_ctrl",false);UpdateAlarmTrigger(e,STR_VLOSS_TO_SNAP,STR_VLOSS_TO_SNAP+"_ctrl",false);UpdateBigView(e,STR_VLOSS_TO_BIGVIEW,STR_VLOSS_TO_BIGVIEW+"_ctrl",false);UpdateAlarmToPtz(e,false,g_curchannel_vloss);h.style.display="";b.innerHTML="<b>"+channel_string+(g+1)+"</b>";g_curchannel_vloss=g;for(var d=0;d<g_local_ch_num+g_net_ch_num;d++){document.getElementsByName("ptz_type")[d].disabled=false;document.getElementsByName("ptz_number")[d].disabled=false}for(k=0;k<g_bUpdataChannel.length;k++){if(k!=g){g_bUpdataChannel[k]=0}else{g_bUpdataChannel[k]=1}}GenSelectListEx(f,g_bigViewList);var e=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");UpdateBooleanTrigger(e,STR_VLOSS_TO_BUZZ,STR_VLOSS_TO_BUZZ+"_ctrl",true);UpdateBooleanTrigger(e,STR_VLOSS_TO_EMAIL,STR_VLOSS_TO_EMAIL+"_ctrl",true);UpdateAlarmTrigger(e,STR_VLOSS_TO_ALARM_OUT,STR_VLOSS_TO_ALARM_OUT+"_ctrl",true);UpdateAlarmTrigger(e,STR_VLOSS_TO_SNAP,STR_VLOSS_TO_SNAP+"_ctrl",true);UpdateBigView(e,STR_VLOSS_TO_BIGVIEW,STR_VLOSS_TO_BIGVIEW+"_ctrl",true);UpdateAlarmToPtz(e,true,g_curchannel_vloss);GenCpList(j,g,g_channelList);UpdateCheckItems(c);UpdateCheckItems(l);Align();EdgeCtrl(a,72);location.href="#div_vloss_trigger"}function onVlossPTZSave(){if(!bTrigger){window.alert(cfg_nochange_tip)}else{var c=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");var a=document.getElementById("div_vloss_trigger");var b=document.getElementById("div_config_index");UpdateValues(c,false);UpdateBooleanTrigger(c,STR_VLOSS_TO_BUZZ,STR_VLOSS_TO_BUZZ+"_ctrl",false);UpdateBooleanTrigger(c,STR_VLOSS_TO_EMAIL,STR_VLOSS_TO_EMAIL+"_ctrl",false);UpdateAlarmTrigger(c,STR_VLOSS_TO_ALARM_OUT,STR_VLOSS_TO_ALARM_OUT+"_ctrl",false);UpdateAlarmTrigger(c,STR_VLOSS_TO_SNAP,STR_VLOSS_TO_SNAP+"_ctrl",false);UpdateBigView(c,STR_VLOSS_TO_BIGVIEW,STR_VLOSS_TO_BIGVIEW+"_ctrl",false);UpdateAlarmToPtz(c,false,g_curchannel_vloss);a.style.display="none";Align();EdgeCtrl(b,72)}for(k=0;k<g_bUpdataChannel.length;k++){g_bUpdataChannel[k]=0}}function onVlossPTZCancel(){var d=document.getElementById("div_config_index");var b=document.getElementById("div_vloss_trigger");var a=document.getElementById("vloss_trigger_out");var c=document.getElementById("vloss_snap");b.style.display="none";UpdateCheckItems(a);UpdateCheckItems(c);Align();EdgeCtrl(d,72);location.href="#div_vloss_trigger";for(k=0;k<g_bUpdataChannel.length;k++){g_bUpdataChannel[k]=0}};
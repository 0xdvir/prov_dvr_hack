var g_xmlhttp=createXMLHttp();var g_xmlDoc=createXMLDoc();var g_xmlCheckConfigDoc=createXMLDoc();var g_xmlCheckSecondConfigDoc=createXMLDoc();var g_mainMenuItem=-1;var g_loginUser="";var g_userListCtrl=0;var g_deviceListCtrl=0;var g_bTalking=false;var g_bBR27=false;var g_bHasArabic=true;var g_bHasRomanian=false;var g_bHasRomanian2=false;var g_fnOnExcuteCmdReply=null;var g_loadPageTimeOut=0;var g_oSerializer=null;var g_bupdate=false;var g_unload=false;var g_KoreaLangOEM=false;var g_US02=false;var g_getPluginTimer=0;var g_nPluginTimerCount=0;var g_loginStatus=0;var g_loginTimer=0;var g_loginErrorTip="";function HostInfo(){}HostInfo.hostname="";HostInfo.hostmac="";if(typeof(HTMLElement)!="undefined"&&!window.opera){HTMLElement.prototype.__defineGetter__("outerHTML",function(){var b=this.attributes,d="<"+this.tagName,c=0;for(;c<b.length;c++){if(b[c].specified){d+=" "+b[c].name+'="'+b[c].value+'"'}}if(!this.canHaveChildren){return d+" />"}return d+">"+this.innerHTML+"</"+this.tagName+">"});HTMLElement.prototype.__defineSetter__("outerHTML",function(a){var b=this.ownerDocument.createRange();b.setStartBefore(this);var c=b.createContextualFragment(a);this.parentNode.replaceChild(c,this);return a});HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return !/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())})}var g_langList=new Array(new CSelectOptionInfo("English","english_us"),new CSelectOptionInfo("简体中文","chinese_prc"),new CSelectOptionInfo("繁體中文","chinese_cht"),new CSelectOptionInfo("Český","Czech"),new CSelectOptionInfo("Français","french_fr"),new CSelectOptionInfo("Português","portuguese"),new CSelectOptionInfo("Español","Spanish"),new CSelectOptionInfo("Türk","turkish_tr"),new CSelectOptionInfo("Български език","bulgarian"),new CSelectOptionInfo("Ελληνικά","greek"),new CSelectOptionInfo("עברית שפה","hebrew"),new CSelectOptionInfo("Italiano","italian"),new CSelectOptionInfo("Deutsch","germany"),new CSelectOptionInfo("Русский","russian_ru"),new CSelectOptionInfo("polski","polish"),new CSelectOptionInfo("日本","japanese"),new CSelectOptionInfo("Indonesia","indonesian"),new CSelectOptionInfo("ภาษาไทย","thai"),new CSelectOptionInfo("Magyar","Hungarian"),new CSelectOptionInfo("Lietuvos","Lithuania"),new CSelectOptionInfo("việt","vietnamese"),new CSelectOptionInfo("Nederlands","Dutch"),new CSelectOptionInfo("Svenska","Swedish"),new CSelectOptionInfo("Danske","Danish"),new CSelectOptionInfo("Norske","Norwegian"),new CSelectOptionInfo("فارسی","farsi"));if(g_bBR27){g_langList.push(new CSelectOptionInfo("한국어","Korean"))}if(g_bHasArabic){g_langList.push(new CSelectOptionInfo("العربية","Arabic"))}if(g_bHasRomanian||g_bHasRomanian2){g_langList.push(new CSelectOptionInfo("român","Romanian"))}if(g_KoreaLangOEM){var len=g_langList.length;var hasCh;var index;for(var i=0;i<len;i++){if(g_langList[i].optionValue=="chinese_prc"){index=i;hasCh=true;break}}if(hasCh){g_langList.splice(index,2,new CSelectOptionInfo("한국어","Korean"))}else{g_langList.splice(1,0,new CSelectOptionInfo("한국어","Korean"))}}if(g_US02){var len=g_langList.length;var index;for(var i=0;i<len;i++){if(g_langList[i].optionValue=="indonesian"){index=i;break}}g_langList.splice(index,1,new CSelectOptionInfo("român","Romanian"))}function serializeXml(b){var a=new XMLSerializer();return a.serializeToString(b)}function FormatToXmlDOM(c){var a=function(){var d=/msie/i.test(navigator.userAgent);return d};var b=function(){var d=null;if(a()){d=new ActiveXObject("Microsoft.XMLDOM");d.loadXML(c)}else{d=(new DOMParser()).parseFromString(c,"text/xml")}return d};return b()}function DealXmlStr(a){a=a.replace(/\r/ig,"");a=a.replace(/\n/ig,"");a=a.replace(/>\s*</g,"><");return a}function createXMLDoc(){xmlDoc=null;try{xmlDoc=document.implementation.createDocument("","",null)}catch(a){try{xmlDoc=new ActiveXObject("Microsoft.XMLDOM")}catch(a){alert(a.message)}}return(xmlDoc)}function createXMLHttp(){xmlhttp=null;if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{return null}}return xmlhttp}function SafeHttpSend(b,a){try{b.send(a)}catch(c){if(c instanceof Error){StopWait();return false}}return true}function GetOSVer(){var a=window.navigator.userAgent;var c=a.split(";")[2];var b=c.substr(c.length-3,3);switch(b){case"5.0":return"Win2000";case"5.1":return"WinXP";case"5.2":return"Win2003";case"6.1":return"Win7";default:return"Others"}}function CSelectOptionInfo(a,b){this.optionName=a;this.optionValue=b}function CDDNSServerInfo(c,a,b){this.optionName=b;this.optionValue=c;this.ddnsId=c;this.hasDomain=a;this.serverName=b}function CEncodeProperty(b,a,c){this.optionName=c;this.optionValue=b;this.resolution=b;this.frameRate=a;this.resolutionName=c}function GenSelectListEx(d,b){d.length=0;for(var c=0;c<b.length;c++){var a=new Option(b[c].optionName,b[c].optionValue);d.options.add(a)}}function LoadMultiJS(d,a){if(d.length==0){a();return}var b=d[0].replace(/\./,"_");if(document.getElementById(b)!=null){d.shift();LoadMultiJS(d,a);return}var c=/msie/i.test(navigator.userAgent);if(!c){g_xmlhttp.open("get","script/"+d[0],false);SafeHttpSend(g_xmlhttp,null);DynAppendJS(b,g_xmlhttp.responseText);d.shift();LoadMultiJS(d,a)}else{g_xmlhttp.open("get","script/"+d[0],false);g_xmlhttp.onreadystatechange=function(){if(g_xmlhttp.readyState==4){DynAppendJS(b,g_xmlhttp.responseText);d.shift();LoadMultiJS(d,a)}};SafeHttpSend(g_xmlhttp,null)}}function LoadMultiJSSync(c){for(var b=0;b<c.length;b++){var a=c[b].replace(/\./,"_");if(document.getElementById(a)!=null){continue}g_xmlhttp.open("get","script/"+c[b],false);SafeHttpSend(g_xmlhttp,null);DynAppendJS(a,g_xmlhttp.responseText)}}function DynAppendJS(a,d){if((d!=null)&&(!document.getElementById(a))){var c=document.getElementsByTagName("HEAD").item(0);var b=document.createElement("script");b.language="javascript";b.type="text/javascript";b.id=a;b.defer=true;b.text=d;c.appendChild(b)}}function LoadMultiString(c,b){var a=c.replace(/\./,"_");jsObj=document.getElementById(a);if(jsObj!=null){document.getElementsByTagName("HEAD")[0].removeChild(jsObj)}g_xmlhttp.open("get","language/"+g_langName+"/"+c,false);SafeHttpSend(g_xmlhttp,null);if(g_xmlhttp.readyState==4){DynAppendJS(a,g_xmlhttp.responseText);if(b!=null){b()}}}function ReLoadMultiJS(c){for(var b=0;b<c.length;b++){var a=c[b].replace(/\./,"_");jsObj=document.getElementById(a);if(document.getElementById(a)!=null){document.getElementsByTagName("HEAD")[0].removeChild(jsObj)}g_xmlhttp.open("get","script/"+c[b],false);SafeHttpSend(g_xmlhttp,null);DynAppendJS(a,g_xmlhttp.responseText)}}function OnResize(){if(g_mainMenuItem==0){var a=document.getElementById("div_main_menu");var b=document.getElementById("div_ocx");b.style.left=a.offsetLeft+5;b.style.top=a.offsetTop+a.offsetHeight;b.style.width=770}}function OnLoadPage(){var t="IE failed to run the client. \rThis IE may not support multi-tab to run the client or too many IE pages opened.";var u="the Plugin start failed!\r\nThe Web Client can only run one instance at a time.";WebClient=null;var r=false;var m=/msie/i.test(navigator.userAgent);if(m){WebClient=document.getElementById("WebClient");r=true;if(g_bCBNUseLogo){var p=document.getElementById("Web_Camera_CNB_Logo");p.style.display=""}}else{if(g_getPluginTimer!=0){g_nPluginTimerCount++}WebClient=document.getElementById("WebClientPlugin");document.getElementById("work_area").style.width="0px";document.getElementById("work_area").style.height="0px";if(g_bCBNUseLogo){var p=document.getElementById("WebClient_CNB_Logo");p.style.display=""}var k="";if(WebClient!=null){var d=navigator.userAgent.toLowerCase();var h=navigator.platform.toLowerCase();var f=false;if(d.indexOf("macintosh")!=-1||d.indexOf("mac os x 10")!=-1||h.indexOf("macintel")!=-1){f=true;try{k=WebClient.GetPluginVersion();if(g_getPluginTimer!=0){clearTimeout(g_getPluginTimer);g_nPluginTimerCount=0}}catch(v){k="";if(g_getPluginTimer==0){g_getPluginTimer=setTimeout(OnLoadPage,1000);return}else{clearTimeout(g_getPluginTimer);if(g_nPluginTimerCount>=3){g_nPluginTimerCount=0}else{g_getPluginTimer=setTimeout(OnLoadPage,1000);return}}}}var n=(d.indexOf("firefox")!=-1);if((f&&(k!=""||WebClient.constructor==Object||(n&&WebClient.constructor.toString().contains("HTMLElement"))))||(!f&&(WebClient.constructor==Object||WebClient.constructor==HTMLEmbedElement||(WebClient.constructor.toString().indexOf("function")!=-1)))){r=true;var d=navigator.userAgent.toLowerCase();var h=navigator.platform.toLowerCase();if(d.indexOf("windows nt")!=-1||h.indexOf("win32")!=-1){if(d.indexOf("firefox")!=-1||d.indexOf("chrome")!=-1||d.indexOf("safari")!=-1){var j="1.2.3.112"}}else{if(d.indexOf("macintosh")!=-1||d.indexOf("mac os x 10")!=-1||h.indexOf("macintel")!=-1){WebClient.OnExcuteCmdNotifyReply=OnExcuteCmdNotifyReply;WebClient.OnNetDisconnect=OnNetDisconnect;WebClient.OnNetReLogined=OnNetReLogined;WebClient.OnDisconnectByServer=OnDisconnectByServer;var j="1.0.5.4"}}try{var c=WebClient.GetPluginVersion();var k=j.split(".");var q=c.split(".");for(i=0;i<4;i++){var z=parseInt(k[i]);var y=parseInt(q[i]);if(z!=y){if(y<z){g_bupdate=true;r=false}break}}}catch(l){g_bupdate=true;r=false}}else{}}}var s=navigator.systemLanguage||navigator.language;s=s.toLowerCase();if(s.indexOf("zh")!=-1){if(s=="zh-cn"){g_langName="chinese_prc"}else{g_langName="chinese_cht"}t="IE 运行客户端失败。\nIE不支持选项卡中运行客户端或是开了太多IE页面。";u="插件启动失败!\r\n网络客户端一次只能运行一个实例."}else{if(s=="cs"){g_langName="Czech"}else{if((s.indexOf("fr-")!=-1)||(s=="fr")){g_langName="french_fr"}else{if(s.indexOf("pt")!=-1){g_langName="portuguese"}else{if(s.indexOf("es")!=-1){g_langName="Spanish"}else{if(s=="tr"){g_langName="turkish_tr"}else{if(s=="bg"){g_langName="bulgarian"}else{if(s=="el"){g_langName="greek"}else{if(s=="he"){g_langName="hebrew"}else{if(s.indexOf("it")!=-1){g_langName="italian"}else{if((s.indexOf("de-")!=-1)||(s=="de")){g_langName="germany"}else{if(s.indexOf("ru")!=-1){g_langName="russian_ru"}else{if(s.indexOf("pl")!=-1){g_langName="polish"}else{if(s.indexOf("ja")!=-1){g_langName="japanese"}else{if(s.indexOf("in")!=-1||s.indexOf("id")!=-1){g_langName="indonesian"}else{if(s.indexOf("th")!=-1){g_langName="thai"}else{if(s.indexOf("hu")!=-1){g_langName="Hungarian"}else{if(s.indexOf("lt")!=-1){g_langName="Lithuania"}else{if(s.indexOf("vi")!=-1){g_langName="vietnamese"}else{if(s.indexOf("nl")!=-1){g_langName="Dutch"}else{if(s.indexOf("fi")!=-1){g_langName="english_us"}else{if(s.indexOf("sv")!=-1){g_langName="Swedish"}else{if(s.indexOf("da")!=-1){g_langName="Danish"}else{if(s.indexOf("no")!=-1){g_langName="Norwegian"}else{if(s.indexOf("uk")!=-1){g_langName="russian_ru"}else{if(s.indexOf("fa")!=-1){g_langName="farsi"}else{if(s.indexOf("ar")!=-1){g_langName="Arabic"}else{if(s.indexOf("ro")!=-1){g_langName="Romanian"}else{if(g_bBR27&&s.indexOf("ko")!=-1){g_langName="Korean"}else{if(g_KoreaLangOEM&&s.indexOf("ko")!=-1){g_langName="Korean"}else{g_langName="english_us"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}try{if(m&&!WebClient.CanInitialize()){window.alert(t);window.close();return}if(!m&&!WebClient.CanInitialize()){window.alert(u);window.close();return}}catch(l){}if(!r&&!m){LoadMultiString("string.js",GotoWebKitPage);if(g_langName!="简体中文"){var w=new Array("device_param.js","cfg_main.js");ReLoadMultiJS(w)}return}try{var g="<request>\r\n";g+='<command name="'+STR_LM_SET_LANGUAGE+'">\r\n';g+="<language>"+g_langName+"</language>\r\n";g+="</command>\r\n";g+="</request>\r\n";WebClient.ExcuteLocalCmd(g);strRequest="<request>\r\n";strRequest+='<command name="'+STR_LM_GET_HOST_INFO+'"></command>\r\n';strRequest+="</request>\r\n";strReply=WebClient.ExcuteLocalCmd(strRequest);if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(strReply);cmdElements=g_xmlDoc.documentElement.getElementsByTagName("command");if(cmdElements.length>0){var x=cmdElements[0].getElementsByTagName(STR_HOST_NAME);var o=cmdElements[0].getElementsByTagName(STR_HOST_MAC);HostInfo.hostname=x[0].childNodes[0].nodeValue;HostInfo.hostmac=o[0].childNodes[0].nodeValue}LoadMultiString("string.js",GotoLoginPage);if(g_langName!="简体中文"){if(!m){var w=new Array("device_param.js","cfg_main.js");ReLoadMultiJS(w)}}}catch(v){g_loadPageTimeOut=setTimeout(OnLoadPage);return}if(g_loadPageTimeOut!=0){clearTimeout(g_loadPageTimeOut)}}function OnUnloadPage(){g_unload=true;WebClient.Unload()}function OnBodyKeyDown(a){var c=document.getElementById("div_login");var d=document.getElementById("login_ok_button");var b=a?a:(window.event?window.event:null);if(c.style.display!="none"){if(b.keyCode==13){d.click()}}}function HideDIVs(){document.getElementById("div_login").style.display="none";document.getElementById("div_login").innerHTML="";document.getElementById("div_ocx").style.width="0px";document.getElementById("div_ocx").style.height="0px";document.getElementById("div_live").style.display="none";document.getElementById("div_live").innerHTML="";document.getElementById("div_playback").style.display="none";document.getElementById("div_playback").innerHTML="";document.getElementById("div_config_index").style.display="none";document.getElementById("div_config_index").innerHTML="";document.getElementById("div_config_body").style.display="none";document.getElementById("div_config_body").innerHTML="";document.getElementById("div_info_index").style.display="none";document.getElementById("div_info_index").innerHTML="";document.getElementById("div_info_body").style.display="none";document.getElementById("div_info_body").innerHTML="";document.getElementById("div_search_body").style.display="none";document.getElementById("div_search_body").innerHTML="";document.getElementById("div_backup_body").style.display="none";var a=/msie/i.test(navigator.userAgent);if(!a){document.getElementById("div_playback_local").style.display="none";document.getElementById("div_playback_local").innerHTML="";document.getElementById("div_search_local_body").style.display="none";document.getElementById("div_search_local_body").innerHTML=""}document.getElementById("ocx_alt_label").style.display="none";WebClient.style.width="0px";WebClient.style.height="0px";document.getElementById("div_config").style.display="none";document.getElementById("div_info").style.display="none";document.getElementById("div_advance_body").style.display="none";WebClient.SetVisible(0)}function StartWait(){var c=document.getElementById("id_wait");var e=document.getElementById("img_wait");c.style.display="";e.style.display="";var g=/msie/i.test(navigator.userAgent);var a;var b;var d;var f=false;if(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1||navigator.userAgent.toLowerCase().indexOf("chrome")!=-1||navigator.userAgent.toLowerCase().indexOf("safari")!=-1){f=true}if(g){a=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight);c.style.height=a+"px";b=Math.round((window.screen.height-e.offsetHeight)/2-window.screenTop);d=Math.round((document.documentElement.clientWidth-e.offsetWidth)/2);e.style.top=b+"px";e.style.left=d+"px"}else{a=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)-80;c.style.height=a+"px";b=Math.round((window.screen.height-e.offsetHeight)/2-window.screenTop)-100;if(f){b=Math.round((window.screen.height-e.offsetHeight)/2-window.screenY)-100}d=Math.round((document.documentElement.clientWidth-e.offsetWidth)/2);e.style.top=b+"px";e.style.left=d+"px"}}function StopWait(){document.getElementById("id_wait").style.display="none";document.getElementById("img_wait").style.display="none"}function StartWaitTip(c){var e=/msie/i.test(navigator.userAgent);var f=document.getElementById("id_wait");var k=document.getElementById("wait_tip_div");var d=document.getElementById("wait_iframe");f.style.display="";k.style.display="";d.style.display="";if(e){k.innerText=c}else{k.textContent=c}var j;var a;var g;j=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight);f.style.height=j+"px";d.style.height=f.style.height;var b=/msie/i.test(navigator.userAgent);if(!b){d.style.width="1000px"}else{d.style.width=f.offsetWidth}var h=false;if(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1||navigator.userAgent.toLowerCase().indexOf("chrome")!=-1||navigator.userAgent.toLowerCase().indexOf("safari")!=-1){h=true}if(h){a=Math.round(document.documentElement.scrollTop+document.documentElement.clientHeight/2-window.screenY)}else{a=Math.round(document.documentElement.scrollTop+document.documentElement.clientHeight/2-window.screenTop)}g=Math.round((document.documentElement.clientWidth-k.offsetWidth)/2);k.style.top=a+"px";k.style.left=g+"px"}function StartWaitTipForUpdate(c,h){var g=document.getElementById("id_wait");var k=document.getElementById("wait_tip_div");var d=document.getElementById("wait_iframe");g.style.display="";k.style.display="";d.style.display="";k.innerHTML=c+'<br/><input type = "button" id = "cancel_update_btn" value = "'+h+'" onclick = "CancelUpdate()" />';var e;var f;var a;e=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight);g.style.height=e+"px";d.style.height=g.style.height;var b=/msie/i.test(navigator.userAgent);if(!b){d.style.width="1000px"}else{d.style.width=g.offsetWidth}var j=false;if(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1||navigator.userAgent.toLowerCase().indexOf("chrome")!=-1||navigator.userAgent.toLowerCase().indexOf("safari")!=-1){j=true}if(j){f=Math.round(document.documentElement.scrollTop+document.documentElement.clientHeight/2-window.screenY)}else{f=Math.round(document.documentElement.scrollTop+document.documentElement.clientHeight/2-window.screenTop)}a=Math.round((document.documentElement.clientWidth-k.offsetWidth)/2);k.style.top=f+"px";k.style.left=a+"px"}function StopWaitTip(){var a=document.getElementById("id_wait");var c=document.getElementById("wait_tip_div");var b=document.getElementById("wait_iframe");a.style.display="none";c.style.display="none";b.style.display="none"}function StopWaitTipForUpdate(){var a=document.getElementById("id_wait");var c=document.getElementById("wait_tip_div");var b=document.getElementById("wait_iframe");a.style.display="none";c.style.display="none";b.style.display="none"}function StartWaitConnect(){var f=document.getElementById("id_wait");var l=document.getElementById("wait_tip_div");var b=document.getElementById("wait_iframe");var g=document.getElementById("wait_tip_div_conn");var c=document.getElementById("img_wait_conn");var j=document.getElementById("wait_tip_conn_text");var d=/msie/i.test(navigator.userAgent);f.style.display="";g.style.display="";c.style.display="";if(d){j.innerText=str_connecting}else{j.textContent=str_connecting}var k;var a;var e;k=Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight);f.style.height=k+"px";var h=false;if(navigator.userAgent.toLowerCase().indexOf("firefox")!=-1||navigator.userAgent.toLowerCase().indexOf("chrome")!=-1||navigator.userAgent.toLowerCase().indexOf("safari")!=-1){h=true}if(h){a=Math.round((f.offsetHeight-g.offsetHeight)/2-window.screenY)}else{a=Math.round((f.offsetHeight-g.offsetHeight)/2-window.screenTop)}e=Math.round((document.documentElement.clientWidth-g.offsetWidth)/2);g.style.top=a+"px";g.style.left=e+"px"}function StopWaitConnect(){var c=document.getElementById("id_wait");var a=document.getElementById("wait_tip_div_conn");var b=document.getElementById("img_wait_conn");c.style.display="none";a.style.display="none";b.style.display="none"}function OnExcuteCmdNotifyReply(a){if(g_fnOnExcuteCmdReply!=null){var b=g_fnOnExcuteCmdReply;g_fnOnExcuteCmdReply(a);if(b==g_fnOnExcuteCmdReply){g_fnOnExcuteCmdReply=null}}}function SetNofityCallback(a){g_fnOnExcuteCmdReply=a}function OnNetDisconnect(b){StopWait();StopWaitTip();g_mainMenuItem=-1;g_bTalking=false;HideDIVs();StartWaitConnect();try{g_backupBackground=false}catch(a){}}function OnNetReLogined(b){StopWaitConnect();try{GotoLivePage()}catch(a){}}function OnDisconnectByServer(a){window.alert(str_disconnect_by_server);window.close()};
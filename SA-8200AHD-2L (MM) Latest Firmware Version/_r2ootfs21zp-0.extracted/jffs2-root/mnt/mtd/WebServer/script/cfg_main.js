var g_curConfigIndex=0;var g_96zero="000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";var g_curchannel_vloss=0;var g_curchannel_motion=0;var g_curchannel_sensor=0;var g_curchannel_net=0;var g_bUpdataChannel=0;var g_channel_index=0;var g_curSchChannel=0;var g_cur_index="sys_config";var g_bChange=false;var bTrigger=false;var b_change1=false;var b_change2=false;var b_change3=false;var g_curDate=0;var g_sch_holiday=new Array(g_channelList);var bAddTest=false;var g_PresetArr=new Array();var g_CruiseArr=new Array();var g_curPageP=0;var g_curPageC=0;var g_presetCIndex=0;var g_cruiseCindex=0;var g_curCruise=-1;var calendar_week=new Array(str_sun,str_mon,str_tue,str_wed,str_thu,str_fri,str_sat);var week_full_spell=new Array(str_sunday,str_monday,str_tuesday,str_wednesday,str_thursday,str_friday,str_saturday);var calendar_month=new Array(str_jan,str_feb,str_mar,str_apr,str_may,str_jun,str_jul,str_aug,str_sep,str_oct,str_nov,str_dec);var str_week_index=new Array(str_firstweed,str_secondweek,str_thirdweek,str_forthweek,str_fifthweek,str_lastweek);var temp_video_format="";var g_maxAlarmRecTime=0;var g_netStreamAllCheckMaxBiteRate=768;var bDChanged=false;var IL03=false;function sizeCountUTF8(){var b=0;for(var a=0;a<this.length;a++){var d=this.charCodeAt(a);if(d<128){b++}else{if(d<2048){b+=2}else{if(d<65536){b+=3}}}}return b}function sizeCountAnsi(){var b=0;for(var a=0;a<this.length;a++){var d=this.charCodeAt(a);if((d>=1&&d<=126)||(65376<=d&&d<=65439)){b++}else{b+=2}}return b}function SubStringOfBytesUTF8(f,b){var e=0;if(b<=0){return""}for(var a=f;a<this.length;a++){var d=this.charCodeAt(a);if(e>b){break}if(d<128){e++}else{if(d<2048){e+=2}else{if(d<65536){e+=3}}}if(e>=b){if(e>b){a--}break}}return this.substr(f,a-f+1)}function SubStringOfBytesAnsi(f,b){var e=0;if(b<=0){return""}for(var a=f;a<this.length;a++){var d=this.charCodeAt(a);if(e>b){break}if((d>=1&&d<=126)||(65376<=d&&d<=65439)){e++}else{e+=2}if(e>=b){if(e>b){a--}break}}return this.substr(f,a-f+1)}String.prototype.sizeUTF8=sizeCountUTF8;String.prototype.SubStringOfBytesUTF8=SubStringOfBytesUTF8;String.prototype.size=sizeCountAnsi;String.prototype.SubStringOfBytes=SubStringOfBytesAnsi;function HolidaySchData(a,b){this.dateInfo=a;this.schInfo=b}function PresetData(c,b,a){this.optionName=c;this.optionValue=b;this.name=c;this.index=b;this.bEnable=a}function PresetInCruise(b,d,c,a){this.index=b;this.PresetIndex=d;this.HoldTime=c;this.Speed=a}function CruiseData(b,a){this.CruiseName=b;if(a==null){this.PresetInfo=new Array()}else{this.PresetInfo=a}}function isNumberInput(d,c){var a,b;if(window.event){a=window.event.keyCode}else{if(c){a=c.which}else{return true}}if(a==null||a==0||a==8||a==13||a==27){return true}b=String.fromCharCode(a);if(/\d/.test(b)){return true}else{return false}}function InputCheck(c,b,a){tempA=c.value;tempB=tempA.replace(/[^0-9]*/g,"");c.value=tempB;if(tempB==""){c.value=a}if(a!=0){if(tempB==0){c.value=a}if(tempB<a){c.value=a}}if(tempB>b){c.value=b}}function LenCheck(e,b,a){var d=e.value;var c=b.charCode|b.keyCode;if(c==null||c==0||c==8||c==13||c==27||c==46){return true}if(d.sizeUTF8()<a){return true}else{e.value=d.SubStringOfBytesUTF8(0,a);e.onchange();return false}}function KeyupCheck(c,a){var b=c.value;if(b.sizeUTF8()>a){c.value=b.SubStringOfBytesUTF8(0,a);c.onchange();return false}return true}function KeyupCheckEx(c,a){var b=c.value;b=b.replace(/[^\w\.\/]/ig,"");if(c.value!=b){c.value=b}if(b.sizeUTF8()>a){c.value=b.SubStringOfBytesUTF8(0,a);c.onchange();return false}return true}function SaveOk(a){a.style.color=save_ok_color;a.innerHTML=save_success_tip}function SaveError(b,a){var c=/msie/i.test(navigator.userAgent);if(c){b.style.color=save_error_color;b.innerText=a}else{b.style.color=save_error_color;b.textContent=a}}function AddTest(a){if((a.value=="")||(a.value<0)||!(parseInt(a.value,10))){a.value="0"}if(a.value>255){a.value="255"}}function UpdateValues(a,c){var b=0;for(i=0;i<a.length;i++){if(a[i].attributes==null){continue}if(a[i].attributes.getNamedItem("name")==null){continue}HtmlName=a[i].attributes.getNamedItem("name").nodeValue;if(a[i].attributes.getNamedItem("index")!=null){index=a[i].attributes.getNamedItem("index").nodeValue}b=document.getElementsByName(HtmlName);if(b.length==0){b=new Array(1);b[0]=document.getElementById(HtmlName);if((b[0]=="undefined")||(b[0]==null)){continue}}if(index>=b.length){continue}if(c){if(b[index].type=="checkbox"){if(a[i].childNodes[0].nodeValue=="0"){b[index].checked=false}else{b[index].checked=true}}else{if(b[0].type=="radio"){for(k=0;k<b.length;k++){if(b[k].value==a[i].childNodes[0].nodeValue){b[k].checked=true;break}}}else{if(b[0].tagName.toLowerCase()=="span"){if(a[i].childNodes[0].nodeValue=="0.0.0.0"){MultiEdit.all[b[0].ipName].setValue("0.0.0.0")}else{tempIp=a[i].childNodes[0].nodeValue.toString();MultiEdit.all[b[0].ipName].setValue(tempIp)}}else{if(a[i].childNodes[0]==null){b[index].value=""}else{b[index].value=a[i].childNodes[0].nodeValue}}}}}else{if(b[index].type=="checkbox"){if((a[i].childNodes[0].nodeValue=="0")||(a[i].childNodes[0].nodeValue=="1")){if(b[index].name=="rec_has_audio"){if(index<g_audioList.length){if(b[index].checked){a[i].childNodes[0].nodeValue="1"}else{a[i].childNodes[0].nodeValue="0"}}else{if(b[parseInt(index,10)+g_local_ch_num-g_audioList.length].checked){a[i].childNodes[0].nodeValue="1"}else{a[i].childNodes[0].nodeValue="0"}}}else{if(b[index].checked){a[i].childNodes[0].nodeValue="1"}else{a[i].childNodes[0].nodeValue="0"}}}}else{if(b[index].type=="radio"){for(k=0;k<b.length;k++){if(b[k].checked){a[i].childNodes[0].nodeValue=b[k].value;break}}}else{if(b[0].tagName.toLowerCase()=="span"){a[i].childNodes[0].nodeValue=MultiEdit.all[b[0].ipName].getValue()}else{if(a[i].childNodes[0]==null){var d=g_xmlDoc.createTextNode(b[index].value);a[i].appendChild(d)}else{a[i].childNodes[0].nodeValue=b[index].value}}}}}}}function CreateConfigEnterXml(){var a="<request>\r\n";a+='<command name="'+STR_REQUEST_CONFIG_ENTER+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";return a}function CreateConfigReqXml(d,a){if(a==null){a=STR_REQUEST_CONFIG_GET}var c="<request>\r\n";c+='<command name="'+a+'">\r\n';for(var b=0;b<d.length;b++){c+='<parameter name="config_item">'+d[b]+"</parameter>\r\n"}c+="</command>\r\n";c+="</request>\r\n";return c}function CreateNATReqXml(d,a){if(a==null){a=STR_REQUEST_NAT_GET}var c="<request>\r\n";c+='<command name="'+a+'">\r\n';for(var b=0;b<d.length;b++){c+='<parameter name="config_item">'+d[b]+"</parameter>\r\n"}c+="</command>\r\n";c+="</request>\r\n";return c}function CreateBitrateReqXml(c,a){if(a==null){a=STR_REQUEST_BITRATE_GET}var b="<request>\r\n";b+='<command name="'+a+'">\r\n';b+='<parameter name="config_item">'+c+"</parameter>\r\n";b+="</command>\r\n";b+="</request>\r\n";return b}function CreateNetChannelInfoReqXml(d,b){var c="<request>\r\n";c+='<command name="'+STR_REQUEST_SUPPORT_VIDEO_ENCODE_INFO+'"stream_type="'+b+'">\r\n';for(var a=0;a<d.length;a++){c+='<parameter name="config_item">'+d[a]+"</parameter>\r\n"}c+="</command>\r\n";c+="</request>\r\n";return c}function GetNetChannelEncodeInfo(l){var d=CreateNetChannelInfoReqXml(net_channel_video_info_arry,l);var g=WebClient.ExcuteCmd(d);if(g==""){return}var o=FormatToXmlDOM(g);o.async=false;var a=o.documentElement.getElementsByTagName("command")[0].getElementsByTagName("Item");g_majorNetChannelEncodeProperty=[];for(var e=0;e<a.length;e++){var b=a[e].getAttribute("channel");var n=a[e].getAttribute("online");g_majorNetChannelEncodeProperty[e]={};g_majorNetChannelEncodeProperty[e].channel=b;g_majorNetChannelEncodeProperty[e].online=n;if(n==1){var f=[];var h=a[e].getElementsByTagName("encInfo");for(var c=0;c<h.length;c++){f[c]={};f[c].channel=b;f[c].videoSize=h[c].getAttribute("videoSize");f[c].Rate=h[c].getAttribute("Rate");f[c].maxBitRate=h[c].getAttribute("maxBitRate")}g_majorNetChannelEncodeProperty[e].encInfo=f}}}function GetDefaultBiteRate(a,c){var b=1024;if(c){if(a==DVRVIDEO_SIZE_3M){b=6144}else{if(a==DVRVIDEO_SIZE_SXGA){b=4096}else{if(a==DVRVIDEO_SIZE_960P){b=4096}else{if(a==DVRVIDEO_SIZE_QVGA){b=4096}else{if(a==DVRVIDEO_SIZE_VGA){b=256}else{if(a==DVRVIDEO_SIZE_960H){b=1024}else{if(a==DVRVIDEO_SIZE_HD720){b=4096}else{if(a==DVRVIDEO_SIZE_HD1080){b=6144}else{if(a==DVRVIDEO_SIZE_D1){b=1024}else{if(a==DVRVIDEO_SIZE_HD1){b=512}else{if(a==DVRVIDEO_SIZE_CIF){b=512}}}}}}}}}}}}else{if(a==DVRVIDEO_SIZE_3M){b=1024*2}else{if(a==DVRVIDEO_SIZE_SXGA){b=1024*2}else{if(a==DVRVIDEO_SIZE_960P){b=1024*2}else{if(a==DVRVIDEO_SIZE_960H){b=1024*2}else{if(a==DVRVIDEO_SIZE_HD720){b=1024*2}else{if(a==DVRVIDEO_SIZE_HD1080){b=1024*2}else{if(a==DVRVIDEO_SIZE_D1){b=1024}else{if(a==DVRVIDEO_SIZE_HD1){b=512}else{if(a==DVRVIDEO_SIZE_CIF){b=512}else{if(a==DVRVIDEO_SIZE_QCIF){b=512}}}}}}}}}}}return b}function GetsuitableBiteRate(c,b,a){var l=[];if(!b){var d=32;var g=768;if(c==DVRVIDEO_SIZE_3M){g=1024*2}else{if(c==DVRVIDEO_SIZE_SXGA){g=1024*2}else{if(c==DVRVIDEO_SIZE_960P){g=1024*2}else{if(c==DVRVIDEO_SIZE_960H){g=1024*2}else{if(c==DVRVIDEO_SIZE_HD720){g=1024*2}else{if(c==DVRVIDEO_SIZE_HD1080){g=1024*2}else{if(c==DVRVIDEO_SIZE_D1){g=1024*2}else{if(c==DVRVIDEO_SIZE_HD1){g=768}else{if(c==DVRVIDEO_SIZE_CIF){if(a&&g_net_ch_num>0){g=512}else{g=768}}else{if(c==DVRVIDEO_SIZE_QCIF){g=768}}}}}}}}}}for(var e=0;e<g_avNetStreamInfo.supportBitrate.length;e++){if(g_avNetStreamInfo.supportBitrate[e].optionValue>g||g_avNetStreamInfo.supportBitrate[e].optionValue<d){continue}l.push(new CSelectOptionInfo(g_avNetStreamInfo.supportBitrate[e].optionName,g_avNetStreamInfo.supportBitrate[e].optionValue))}if(a){for(var h=0;h<g_majorNetChannelEncodeProperty.length;h++){if(g_majorNetChannelEncodeProperty[h].online==1){var m=g_majorNetChannelEncodeProperty[h].encInfo;for(var f=0;f<m.length;f++){if(m[f].videoSize==c){g=(g>m[f].maxBitRate)?(m[f].maxBitRate):(g)}}}}g_netStreamAllCheckMaxBiteRate=g}}else{var d=0;var g=0;if(IsMixDvr()){if(c==DVRVIDEO_SIZE_3M){d=12*1024;g=512}else{if(c==DVRVIDEO_SIZE_HD1080){g=12*1024;g=512}else{if(c==DVRVIDEO_SIZE_960P){g=6*1024;g=512}else{if(c==DVRVIDEO_SIZE_HD720){g=6*1024;g=512}else{if(c==DVRVIDEO_SIZE_960H){g=2*1024+512;g=512}else{if(c==DVRVIDEO_SIZE_D1){g=2*1024}else{if(c==DVRVIDEO_SIZE_VGA){g=1.5*1024}else{if(c==DVRVIDEO_SIZE_CIF){g=1.5*1024}else{if(c==DVRVIDEO_SIZE_HD1){g=1.5*1024}else{g=0;g=0}}}}}}}}}}else{if(c==DVRVIDEO_SIZE_HD720){g=6*1024}else{if(c==DVRVIDEO_SIZE_HD1080){g=12*1024}else{if(c==DVRVIDEO_SIZE_960P){g=6*1024}else{if(c==DVRVIDEO_SIZE_SXGA){g=6*1024}else{if(c==DVRVIDEO_SIZE_3M){g=12*1024}else{if(c==DVRVIDEO_SIZE_D1){g=2*1024}else{if(c==DVRVIDEO_SIZE_960H){g=2560}else{if(c==DVRVIDEO_SIZE_CIF){g=1024}else{g=2*1024}}}}}}}}}for(var e=0;e<g_avStreamInfo.supportBitrate.length;e++){if(g_avStreamInfo.supportBitrate[e].optionValue>g||g_avStreamInfo.supportBitrate[e].optionValue<d){continue}l.push(new CSelectOptionInfo(g_avStreamInfo.supportBitrate[e].optionName,g_avStreamInfo.supportBitrate[e].optionValue))}}return l}function IsMixDvr(){var a=parseInt(const_hardware_ver.split(".")[0],10);if(a==TD_2304SS_SDI||a==TD_2308SS_SDI||a==TD_2508HE_SDI||a==TD_2512HE_SDI||a==TD_2524HE_SDI){return true}return false}function GetSelcetionsString(b){var a=0;if(b==1){a=0}else{if(b==2){a=1}else{if(b==4){a=2}else{if(b==8){a=3}else{if(b==16){a=4}else{if(b==32){a=5}else{if(b==64){a=6}else{if(b==128){a=7}else{if(b==256){a=8}else{if(b==512){a=9}else{if(b==1024){a=10}else{if(b==2048){a=11}else{if(b==4096){a=12}else{if(b==8192){a=13}else{if(b==16384){a=14}}}}}}}}}}}}}}}return g_videoResolutionArray[a]}function CheckIsNetChannel(a){if(a>=g_local_ch_num&&a<g_local_ch_num+g_net_ch_num){return true}return false}function CreateConfigExitXml(){var a="<request>\r\n";a+='<command name="'+STR_REQUEST_CONFIG_EXIT+'">\r\n';a+="</command>\r\n";a+="</request>\r\n";return a}function GotoConfigPage(){var b=CreateConfigReqXml(sys_const_array);var a=WebClient.ExcuteCmd(b);try{OnReplyConstItems(a)}catch(c){a=WebClient.ExcuteCmd(b);OnReplyConstItems(a)}}function OnReplyConstItems(b){var a=document.getElementById("div_main_menu");var e=document.getElementById("div_config_index");var c=document.getElementById("div_config_body");var d=document.getElementById("div_config");if(b==""){StopWait();return}OnConstItemProc(b);g_mainMenuItem=3;selected(g_mainMenuItem);HideDIVs();a.style.display="";e.style.display="";c.style.display="";d.style.display="";g_lastNav="";g_lastNavSec="";if(g_xmlhttp==null){StopWait();return}g_xmlhttp.open("get","body_html/body_config_index.html",false);SafeHttpSend(g_xmlhttp,null);OnReceiveConfigIndex();if(navigator.userAgent.toLowerCase().indexOf("macintosh")!=-1||navigator.userAgent.toLowerCase().indexOf("mac os x 10")!=-1||navigator.platform.toLowerCase().indexOf("macintel")!=-1){String.prototype.size=sizeCountUTF8;String.prototype.SubStringOfBytes=SubStringOfBytesUTF8}}function OnReceiveConfigIndex(){var b=document.getElementById("div_config_index");var g;if(g_xmlhttp.readyState!=4){return}g=g_xmlhttp.responseText;b.innerHTML=g;b.actualHeight=b.offsetHeight;EdgeCtrl(b,72);ApplyXmlLang("cfg_index.xml");if(!g_supportFunctions.IsSupportPTZ()){var r=document.getElementById("m07_ptz");r.style.display="none"}if(g_supportFunctions.IsNotSupportAlarm()){var t=document.getElementById("f09");var a=document.getElementById("f08");var s=document.getElementById("f14");var d=document.getElementById("f05");if(0==g_net_ch_num){t.style.display="none";var q=t.parentNode;var c=q.parentNode;c.removeChild(q);a.style.display="none";var q=a.parentNode;var c=q.parentNode;c.removeChild(q)}s.style.display="none";var q=s.parentNode;var c=q.parentNode;c.removeChild(q);if(0==g_net_ch_num){d.style.display="none";var q=d.parentNode;var c=q.parentNode;c.removeChild(q)}}if(!g_supportFunctions.IsSupportConfigExport()&&!g_supportFunctions.IsSupportConfigImport()){var n=document.getElementById("m10");n.style.display="none"}if(g_local_ch_num==0){if(!g_supportFunctions.IsSupportSetIpSubEncode()){var p=document.getElementById("f16");p.parentNode.style.display="none"}}if((g_local_ch_num==0&&g_net_ch_num>0)){if(!g_supportFunctions.IsSupportSetIPEncode()){var e=document.getElementById("f02");e.parentNode.style.display="none";var o=document.getElementById("m03");if(g_US02){o.href="javascript:var m03 = document.getElementById('m03');HintSave(52);GotoConfigBody('body_motion_alarm.html', 52);NavSelected(m03);NavSelected(document.getElementById('f06'));"}else{o.href="javascript:var m03 = document.getElementById('m03');HintSave(31);GotoConfigBody('body_rec_basic.html', 31);NavSelected(m03);NavSelected(document.getElementById('f01'));"}}}if(g_net_ch_num==0){var m=document.getElementById("m11");m.style.display="none";m.parentNode.style.display="none"}if(!g_supportFunctions.IsSupportServer()){var l=document.getElementById("f26");l.style.display="none";var q=l.parentNode;var c=q.parentNode;c.removeChild(q)}if(!g_supportFunctions.IsSupportFTP()){var h=document.getElementById("f27");h.style.display="none";h.parentNode.style.display="none"}if(bUseNat){var f=document.getElementById("f28");if(f){f.style.display="none";f.parentNode.style.display="none"}}OnEnterDefaultCfgPage()}function OnEnterDefaultCfgPage(){var a=document.getElementById("m09");StopWait();g_curConfigIndex=0;NavSelected(a);GotoLocalConfig("body_web_config.html",9)}function GotoLocalConfig(c,b){var a=document.getElementById("div_config_body");if(g_curConfigIndex==b){return}g_curConfigIndex=b;a.style.display="";if(g_xmlhttp==null){return}g_xmlhttp.open("get","body_html/"+c,false);StartWait();SafeHttpSend(g_xmlhttp,null);OnReceiveConfigBody()}function GotoConfigBody(c,b){var a=document.getElementById("div_config_body");if(g_curConfigIndex==b){return}g_bChange=false;a.style.display="none";a.innerHTML="";if(!(g_authority.authority&256)){if(b!=8){g_curConfigIndex=-1;window.alert(str_no_auth);return}}if(!OnConfigEnter(b)){g_curConfigIndex=-1;return}g_curConfigIndex=b;if(g_xmlhttp==null){return}a.style.display="";g_xmlhttp.open("get","body_html/"+c,false);StartWait();SafeHttpSend(g_xmlhttp,null);OnReceiveConfigBody()}function OnReceiveConfigBody(){var b=document.getElementById("div_config_body");var c=document.getElementById("div_config_index");var a;if(g_xmlhttp.readyState!=4){StopWait();return}b.innerHTML=g_xmlhttp.responseText;EdgeCtrl(c,72);OnRefreshConfig();EdgeCtrl(c,72)}function OnConfigEnter(b){var e=CreateConfigEnterXml();var a=WebClient.ExcuteCmd(e);var d=document.getElementById("div_config_index");if(a==""){return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);g_xmlDoc.async=false;var f=g_xmlDoc.documentElement.getElementsByTagName("command");if(f[0].attributes.getNamedItem("name").nodeValue!=STR_REPLY_CONFIG_SUCC){if(f[0].attributes.getNamedItem("name").nodeValue==STR_REPLY_NO_AUTH){window.alert(str_no_auth)}else{if(f[0].attributes.getNamedItem("name").nodeValue==STR_REPLY_CONFIG_FAIL){if(f[0].getElementsByTagName("parameter")[0].childNodes[0].nodeValue==STR_USED_BY_OTHER){var c=document.getElementById("div_config_body");var d=document.getElementById("div_config_index");c.style.display="none";d.style.height=(d.actualHeight<c.offsetHeight)?c.offsetHeight:d.actualHeight+20;c.style.height=(c.offsetHeight<d.offsetHeight-2)?d.offsetHeight-2:c.offsetHeight;window.alert(str_config_by_other)}else{window.alert("")}}}return false}return true}function OnConfigExit(){var a=CreateConfigExitXml();WebClient.ExcuteCmd(a)}function OnDeviceExit(){var b="<request>\r\n";b+='<command name="'+STR_REQUEST_CFG_LEAVE_IPCAM+'">\r\n';b+="</command>\r\n";b+="</request>\r\n";var a=WebClient.ExcuteCmd(b)}function OnConstItemProc(A){var J=false;var s=false;var l=false;var b=false;g_languageList=0;g_emailSnapPeriodArray=null;g_ptzProtocol=[];if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(A);g_xmlDoc.async=false;var H=g_xmlDoc.documentElement.getElementsByTagName("command");var r=H[0].getElementsByTagName("parameter");for(F=0;F<r.length;F++){if(r[F].attributes.getNamedItem("name").nodeValue==STR_VIDEO_FORMAT){if(r[F].childNodes[0].nodeValue=="1"){g_videoFormat="PAL"}else{g_videoFormat="NTSC"}break}}for(var F=0;F<r.length;F++){var q=r[F].attributes.getNamedItem("name").nodeValue;var g=r[F].childNodes[0].nodeValue;if(q==STR_DEVICE_NAME_MAX_LEN){const_device_name_len=g}else{if(q==STR_TIME_SERVER_MAX_LEN){const_time_server_max_len=g}else{if(q==STR_UPNP_NAME_MAX_LEN){const_upnp_name_max_len=g}else{if(q==STR_CAMERA_NAME_MAX_LEN){const_camara_name_max_len=g}else{if(q==STR_LIVE_TEXT1234_MAX_LEN){const_live_text1234_max_len=g}else{if(q==STR_LIVE_TEXT5_MAX_LEN){const_live_text5_max_len=g}else{if(q==STR_LIVE_TEXT6_MAX_LEN){const_live_text6_max_len=g}else{if(q==STR_SENSOR_NAME_MAX_LEN){const_sensor_name_max_len=g}else{if(q==STR_ALARMOUT_NAME_MAX_LEN){const_alarmout_name_max_len=g}else{if(q==STR_PPPOP_USERNAME_MAX_LEN){const_pppoe_username_max_len=g}else{if(q==STR_PPPOE_PASSWORD_MAX_LEN){const_pppoe_password_max_len=g}else{if(q==STR_DDNS_USERNAME_MAX_LEN){const_ddns_uername_max_len=g}else{if(q==STR_DDNS_PASSWORD_MAX_LEN){const_ddns_password_max_len=g}else{if(q==STR_DDNS_DOMAIN_MAX_LEN){const_ddns_domain_max_len=g}else{if(q==STR_WIRELESS_SSID_MAX_LEN){const_wireless_ssid_max_len=g}else{if(q==STR_WIRELESS_KEY_MAX_LEN){const_wireless_key_max_len=g}else{if(q==STR_SUPPORT_VIDEOFORMAT){const_support_video_format=g}else{if(q==STR_USER_MAXNUM){const_user_max_num=g}else{if(q==STR_HOLIDAY_MAX_NUM){const_holiday_max_num=g}else{if(q==STR_DEVUSER_NAME_MAX_LEN){const_username_max_len=g}else{if(q==STR_DEVUSER_PWD_MAX_LEN){const_password_max_len=g}else{if(q==STR_FILTER_IP_MAXNUM){const_filter_ip_max_num=g}else{if(q==STR_FILTER_MAC_MAXNUM){const_filter_mac_max_num=g}else{if(q==STR_BAN_ALLOW_NUM){const_ban_allow_num=parseInt(g)}else{if(q==STR_MAJOR_SUPPORT_BITRATE_RANGE){J=true;if(r[F].attributes.getNamedItem("count")!=null){g_avStreamInfo.supportBitrate=new Array(0)}g_avStreamInfo.supportBitrate[g_avStreamInfo.supportBitrate.length]=new CSelectOptionInfo(g+"kbps",parseInt(g,10));g_avStreamInfo.defaultBitrate=parseInt(g,10)}else{if(q==STR_MAJOR_SUPPORT_VBR_LEVELNUM){s=true;if(r[F].attributes.getNamedItem("count")!=null){g_avStreamInfo.supportQuarlity=new Array(0)}var m=parseInt(g,10);g_avStreamInfo.supportQuarlity[g_avStreamInfo.supportQuarlity.length]=new CSelectOptionInfo(g_vbrLevelString[m-1],m);g_avStreamInfo.defaultQuarlity=parseInt(g,10)}else{if(q==STR_MAJOR_SUPPORT_ENCODEMODE){if(r[F].attributes.getNamedItem("count")!=null){g_avStreamInfo.supportEncodeMode=new Array(0);var f=parseInt(g,10);if(f&1){g_avStreamInfo.supportEncodeMode[g_avStreamInfo.supportEncodeMode.length]=new CSelectOptionInfo(str_vbr,1)}if(f&2){g_avStreamInfo.supportEncodeMode[g_avStreamInfo.supportEncodeMode.length]=new CSelectOptionInfo(str_cbr,2)}}else{g_avStreamInfo.defaultEncodeMode=parseInt(g,10)}}else{if(q==STR_MAJOR_SUPPORT_ENCODE_PROPERTY){var L=g.split("+");var e=parseInt(r[F].attributes.getNamedItem("index").nodeValue,10);if(e==0){g_avStreamInfo.resolution=new Array(0);g_avStreamInfo.totalRatePalOnCif=new Array(0);g_avStreamInfo.chnnRatePalOnCif=new Array(0);g_avStreamInfo.totalRateNtscOnCif=new Array(0);g_avStreamInfo.chnnRateNtscOnCif=new Array(0);g_avStreamInfo.defaultResolution=new Array(0);g_avStreamInfo.defaultChnnRateNumPal=new Array(0);g_avStreamInfo.defaultChnnRateNumNtsc=new Array(0);g_majorEncodeProperty=new Array(0);g_majorNetChannelEncodeProperty=new Array(0)}g_majorEncodeProperty[g_majorEncodeProperty.length]=new Array(0);g_majorNetChannelEncodeProperty[g_majorNetChannelEncodeProperty.length]=new Array(0);g_avStreamInfo.resolution[g_avStreamInfo.resolution.length]=parseInt(L[0],10);g_avStreamInfo.totalRatePalOnCif[g_avStreamInfo.totalRatePalOnCif.length]=parseInt(L[1],10);g_avStreamInfo.chnnRatePalOnCif[g_avStreamInfo.chnnRatePalOnCif.length]=parseInt(L[2],10);g_avStreamInfo.totalRateNtscOnCif[g_avStreamInfo.totalRateNtscOnCif.length]=parseInt(L[3],10);g_avStreamInfo.chnnRateNtscOnCif[g_avStreamInfo.chnnRateNtscOnCif.length]=parseInt(L[4],10);g_avStreamInfo.defaultResolution[g_avStreamInfo.defaultResolution.length]=parseInt(L[5],10);g_avStreamInfo.defaultChnnRateNumPal[g_avStreamInfo.defaultChnnRateNumPal.length]=parseInt(L[6],10);g_avStreamInfo.defaultChnnRateNumNtsc[g_avStreamInfo.defaultChnnRateNumNtsc.length]=parseInt(L[7],10);IL03=parseInt(const_software_ver.split("-")[2])==13;if(IL03){g_videoResolutionArray[6]="960H";g_videoResolutionArray[11]="3MP";g_videoResolutionArray[12]="3MP 16:9";g_videoResolutionArray[13]="4MP"}var n=parseInt(const_hardware_ver.split(".")[1],10);if(3==n){g_videoResolutionArray[6]="960H"}var G=g_videoResolutionArray;if(g_US02&&g_net_ch_num<=0){var B=true;var d=0;for(var p=0;p<g_videoResolutionArray.length;p++){if(g_avStreamInfo.resolution[g_avStreamInfo.resolution.length-1]&(1<<p)){if((1<<p)!=DVRVIDEO_SIZE_CIF&&(1<<p)!=DVRVIDEO_SIZE_D1&&(1<<p)!=DVRVIDEO_SIZE_960H){B&=0;break}else{d++}}}if(B&&d>=2){G=[];G=new Array("QCIF","Good(CIF)","HD1","Better(D1)","1080P","720P","Best(960H)")}}for(var p=0;p<G.length;p++){if(g_avStreamInfo.resolution[g_avStreamInfo.resolution.length-1]&(1<<p)){var a=(g_videoFormat=="PAL")?g_avStreamInfo.chnnRatePalOnCif[g_avStreamInfo.chnnRatePalOnCif.length-1]:g_avStreamInfo.chnnRateNtscOnCif[g_avStreamInfo.chnnRateNtscOnCif.length-1];a=RealFrameRate(a,1<<p);if(g_videoFormat=="PAL"){a=(a>25)?25:a}else{a=(a>30)?30:a}var D=CreateRangeOptions(1,a,1);g_majorEncodeProperty[g_majorEncodeProperty.length-1][g_majorEncodeProperty[g_majorEncodeProperty.length-1].length]=new CEncodeProperty(1<<p,D,G[p])}}}else{if(q==STR_MINOR_SUPPORT_BITRATE_RANGE){l=true;if(r[F].attributes.getNamedItem("count")!=null){g_avNetStreamInfo.supportBitrate=new Array(0)}g_avNetStreamInfo.supportBitrate[g_avNetStreamInfo.supportBitrate.length]=new CSelectOptionInfo(g+"kbps",parseInt(g,10));g_avNetStreamInfo.defaultBitrate=parseInt(g,10)}else{if(q==STR_MINOR_SUPPORT_VBR_LEVELNUM){b=true;if(r[F].attributes.getNamedItem("count")!=null){g_avNetStreamInfo.supportQuarlity=new Array(0)}var m=parseInt(g,10);g_avNetStreamInfo.supportQuarlity[g_avNetStreamInfo.supportQuarlity.length]=new CSelectOptionInfo(g_vbrLevelString[m-1],m);g_avNetStreamInfo.defaultQuarlity=parseInt(g,10)}else{if(q==STR_MINOR_SUPPORT_ENCODEMODE){if(r[F].attributes.getNamedItem("count")!=null){g_avNetStreamInfo.supportEncodeMode=new Array(0);var f=parseInt(g,10);if(f&1){g_avNetStreamInfo.supportEncodeMode[g_avNetStreamInfo.supportEncodeMode.length]=new CSelectOptionInfo(str_vbr,1)}if(f&2){g_avNetStreamInfo.supportEncodeMode[g_avNetStreamInfo.supportEncodeMode.length]=new CSelectOptionInfo(str_cbr,2)}}else{g_avNetStreamInfo.defaultEncodeMode=parseInt(g,10)}}else{if(q==STR_MINOR_SUPPORT_ENCODE_PROPERTY){var L=g.split("+");g_avNetStreamInfo.resolution=parseInt(L[0],10);g_avNetStreamInfo.totalRatePalOnCif=parseInt(L[1],10);g_avNetStreamInfo.chnnRatePalOnCif=parseInt(L[2],10);g_avNetStreamInfo.totalRateNtscOnCif=parseInt(L[3],10);g_avNetStreamInfo.chnnRateNtscOnCif=parseInt(L[4],10);g_avNetStreamInfo.defaultResolution=parseInt(L[5],10);g_avNetStreamInfo.defaultChnnRateNumPal=parseInt(L[6],10);g_avNetStreamInfo.defaultChnnRateNumNtsc=parseInt(L[7],10);g_minorEncodeProperty=new Array(0);for(var p=0;p<g_videoResolutionArray.length;p++){if(g_avNetStreamInfo.resolution&(1<<p)){var a=(g_videoFormat=="PAL")?g_avNetStreamInfo.chnnRatePalOnCif:g_avNetStreamInfo.chnnRateNtscOnCif;a=RealFrameRate(a,1<<p);var n=parseInt(const_hardware_ver.split(".")[0],10);if(g_videoFormat=="PAL"){a=(a>25)?25:a}else{a=(a>30)?30:a}var D=CreateRangeOptions(1,a,1);g_minorEncodeProperty[g_minorEncodeProperty.length]=new CEncodeProperty(1<<p,D,g_videoResolutionArray[p])}}}else{if(q==STR_DDNS_SERVER_INFO){var w=parseInt(r[F].attributes.getNamedItem("index").nodeValue,10);if(w==0){if(r[F].attributes.getNamedItem("count")!=null){var v;v=parseInt(r[F].attributes.getNamedItem("count").nodeValue,10);g_ddnsDomainInfo=new Array(v)}else{g_ddnsDomainInfo=new Array(1)}}var y=g;var t=parseInt(y,10);var E=y.indexOf("+");y=y.substring(E+1);var o=parseInt(y,10);E=y.indexOf("+");y=y.substring(E+1);E=y.indexOf(":");y=y.substring(E+1);g_ddnsDomainInfo[w]=new CDDNSServerInfo(t,o,y)}else{if(q==STR_VGA_SUPPORT_RESOLUTION){g_vgaResolution=new Array();var d=0;var I=parseInt(g,10);if(I&1){g_vgaResolution[0]=new CSelectOptionInfo("CVBS",1);d++}if(I&2){g_vgaResolution[d]=new CSelectOptionInfo("720 X 480",2);d++}if(I&4){g_vgaResolution[d]=new CSelectOptionInfo("720 X 576",4);d++}if(I&8){g_vgaResolution[d]=new CSelectOptionInfo("800 X 600",8);d++}if(I&16){g_vgaResolution[d]=new CSelectOptionInfo("1024 X 768",16);d++}if(I&32){g_vgaResolution[d]=new CSelectOptionInfo("1280 X 960",32);d++}if(I&64){g_vgaResolution[d]=new CSelectOptionInfo("1280 X 1024",64);d++}if(I&128){g_vgaResolution[d]=new CSelectOptionInfo("1920 X 1080",128);d++}}else{if(q==STR_SUPPORT_LANGUAGE){if(g_languageList==0){g_languageList=new Array(0)}var z=g.split("+");var e=0;for(e=0;e<32;e++){if((1<<e)==parseInt(z[0])){break}}if(g_bBR27&&e==1){g_languageString[1]=koreanstr}if(g_KoreaLangOEM&&e==1){g_languageString[1]=koreanstr}else{g_languageString[1]=chinese_sstr}if(g_bHasArabic&&e==25){g_languageString[25]=arabicstr}else{g_languageString[25]=finnishstr}if(g_bHasRomanian&&e==27){g_languageString[27]=romanianstr}else{g_languageString[27]=danishstr}if((g_bHasRomanian2||g_US02)&&e==17){g_languageString[17]=romanianstr}else{g_languageString[17]=indonesia}g_languageList[g_languageList.length]=new CSelectOptionInfo(g_languageString[e],z[0])}else{if(q==STR_SUPPORT_PTZ_INFO){if(g_ptzProtocol==null){g_ptzProtocol=new Array()}var c=g.split("*");for(var C=0;C<c.length;C++){var x=c[C].split("+");g_ptzProtocol[g_ptzProtocol.length]=new CSelectOptionInfo(x[1],x[0])}}else{if(q==STR_ENCODE_SIZE_MAJOR_ALL_CH){g_majorEncodeSizeAllCh=("1"==g)}else{if(q==STR_ENCODE_SIZE_MINOR_ALL_CH){g_minorEncodeSizeAllCh=("1"==g)}else{if(q==STR_ENCODE_SIZE_PHONE_ALL_CH){g_phoneEncodeSizeAllCh=("1"==g)}else{if(q==STR_SUPPORT_REC_REDUNDANCY){g_supportRecRedundancy=("1"==g)}else{if(q==STR_MAX_PRE_ALARM_TIME){g_preAlarmRecTime=new Array();var K=parseInt(g,10);g_maxAlarmRecTime=K;if(K<5){g_preAlarmRecTime[0]=new CSelectOptionInfo(K,K)}else{for(var u=1;u*5<=K;u++){g_preAlarmRecTime[u-1]=new CSelectOptionInfo(u*5,u*5)}}}else{if(q==STR_SUPPORT_SYNC_TIME){g_supportSyncTime=(g==1)}else{if(q==STR_SUPPORT_DST){g_supportDst=(g==1)}else{if(q==STR_SUPPORT_MASK_AREA){g_supportMaskArea=(g==1)}else{if(q==STR_SUPPORT_MAIN_MONITOR_SPOT){g_supportMainMonitorSpot=(g==1)}else{if(q==STR_MAJOR_HAVE_ENCODE_AND_MAXBIT){g_supportMajorEncTypeAndBitrate=(g==1)}else{if(q==STR_MINOR_HAVE_ENCODE_AND_MAXBIT){g_supportMinorEncTypeAndBitrate=(g==1)}else{if(q==STR_SUPPORT_SIMPLE_USER_MANAGE){g_supportSimpleUserMan=(g==1)}else{if(q==STR_EMAIL_IMG_NUM_RANGE){if(r[F].attributes.getNamedItem("count")!=null){g_emailSnapNumArray=new Array()}if(g=="0"){g_emailSnapNumArray[g_emailSnapNumArray.length]=new CSelectOptionInfo(str_none,g)}else{g_emailSnapNumArray[g_emailSnapNumArray.length]=new CSelectOptionInfo(g,g)}}else{if(q==STR_EMAIL_SNAP_TIME_RANGE){if(r[F].attributes.getNamedItem("count")!=null){g_emailSnapPeriodArray=new Array()}if(g_emailSnapPeriodArray==null){g_emailSnapPeriodArray=new Array()}g_emailSnapPeriodArray[g_emailSnapPeriodArray.length]=new CSelectOptionInfo(g,g)}else{if(q==STR_REC_SNAP_TIME_RANGE){if(r[F].attributes.getNamedItem("count")!=null){g_recSnapArray=new Array()}if(g_recSnapArray==null){g_recSnapArray=new Array()}g_recSnapArray[g_recSnapArray.length]=new CSelectOptionInfo(g,g)}else{if(q==STR_REC_IMG_NUM_RANGE){if(r[F].attributes.getNamedItem("count")!=null){g_recSnapNumArray=new Array()}if(g=="0"){g_recSnapNumArray[g_recSnapNumArray.length]=new CSelectOptionInfo(str_none,g)}else{g_recSnapNumArray[g_recSnapNumArray.length]=new CSelectOptionInfo(g,g)}}else{if(q==STR_SNAP_QULITY_LEVELNUM){g_recSnapLevelNum=new Array();var h=0;var I=parseInt(g,10);if(I&2){g_recSnapLevelNum[0]=new CSelectOptionInfo(lower_string,2);h++}if(I&3){g_recSnapLevelNum[h]=new CSelectOptionInfo(low_string,3);h++}if(I&4){g_recSnapLevelNum[h]=new CSelectOptionInfo(medium_string,4);h++}if(I&5){g_recSnapLevelNum[h]=new CSelectOptionInfo(higher_string,5);h++}if(I&6){g_recSnapLevelNum[h]=new CSelectOptionInfo(highest_string,6);h++}}else{if(q==STR_SNAP_SIZE_RANGE){g_recSnapSizeRange=new Array();var I=parseInt(g,10);if(I&1){g_recSnapSizeRange[g_recSnapSizeRange.length]=new CSelectOptionInfo("QCIF",1)}if(I&2){g_recSnapSizeRange[g_recSnapSizeRange.length]=new CSelectOptionInfo("CIF",2)}if(I&4){g_recSnapSizeRange[g_recSnapSizeRange.length]=new CSelectOptionInfo("HD1",4)}if(I&8){g_recSnapSizeRange[g_recSnapSizeRange.length]=new CSelectOptionInfo("D1",8)}if(I&16){g_recSnapSizeRange[g_recSnapSizeRange.length]=new CSelectOptionInfo("1080p",16)}}else{if(q==STR_MAJOR_SUPPORT_SPE){var L=g.split("+");g_majorSpe.bVideoSizeSpecial=parseInt(L[0],10);g_majorSpe.videoSizeCIFChnnBits=L[1];g_majorSpe.videoSizeD1ChnnBits=L[2]}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}if(J){g_avStreamInfo.supportBitrate.pop()}if(s){g_avStreamInfo.supportQuarlity.pop()}if(l){g_avNetStreamInfo.supportBitrate.pop()}if(b){g_avNetStreamInfo.supportQuarlity.pop()}return true}var OnLoadCfg=null;function OnRefreshConfig(){g_curchannel_vloss=0;g_curchannel_motion=0;g_curchannel_sensor=0;g_channel_index=0;g_curSchChannel=0;g_curSchType="rec_sch_motion_week";g_bUpdataChannel=new Array();var a=g_ch_num;if(g_ch_num<(const_sensor_num+g_net_ch_num)){a=const_sensor_num+g_net_ch_num}for(k=0;k<a;k++){g_bUpdataChannel[k]=0}var b=null;if(g_curConfigIndex==1){OnLoadCfg="OnLoadCfgBasic()";b=new Array("cfg_basic.js","ctrl_time.js","ctrl_calendar.js")}else{if(g_curConfigIndex==2){OnLoadCfg="OnLoadCfgLive()";b=new Array("cfg_live.js")}else{if((g_curConfigIndex==3)||(g_curConfigIndex==32)){OnLoadCfg="OnLoadCfgRecStream()";b=new Array("cfg_record.js")}else{if(g_curConfigIndex==34){OnLoadCfg="OnLoadCfgRecSnap()";b=new Array("cfg_record.js")}else{if(g_curConfigIndex==31){OnLoadCfg="OnLoadCfgRecBasic()";b=new Array("cfg_record.js")}else{if(g_curConfigIndex==33){OnLoadCfg="OnLoadCfgRecOSD()";b=new Array("cfg_rec_osd.js")}else{if((g_curConfigIndex==4)||(g_curConfigIndex==41)){OnLoadCfg="OnLoadCfgRecSchedule()";b=new Array("ctrl_time.js","cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if(g_curConfigIndex==42){OnLoadCfg="OnLoadCfgRecMotionSchedule()";b=new Array("cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if(g_curConfigIndex==43){OnLoadCfg="OnLoadCfgRecSensorSchedule()";b=new Array("cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if((g_curConfigIndex==5)||(g_curConfigIndex==52)){OnLoadCfg="OnLoadCfgMotionAlarm()";b=new Array("pub_cfg_alarm.js","cfg_motion_alarm.js")}else{if(g_curConfigIndex==51){OnLoadCfg="OnLoadCfgAlarmout()";b=new Array("pub_cfg_alarm.js","cfg_alarmout.js")}else{if(g_curConfigIndex==53){OnLoadCfg="OnLoadCfgSensorAlarm()";b=new Array("pub_cfg_alarm.js","cfg_sensor_alarm.js")}else{if(g_curConfigIndex==54){OnLoadCfg="OnLoadCfgVlossAlarm()";b=new Array("pub_cfg_alarm.js","cfg_vloss_alarm.js")}else{if(g_curConfigIndex==55){OnLoadCfg="OnLoadCfgOtherAlarm()";b=new Array("pub_cfg_alarm.js","cfg_other_alarm.js")}else{if(g_curConfigIndex==56){OnLoadCfg="OnLoadCfgMotionSchedule()";b=new Array("ctrl_time.js","cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if(g_curConfigIndex==57){OnLoadCfg="OnLoadCfgSensorSchedule()";b=new Array("ctrl_time.js","cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if(g_curConfigIndex==58){OnLoadCfg="OnLoadCfgNetAlarmSchedule()";b=new Array("ctrl_time.js","cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if(g_curConfigIndex==59){OnLoadCfg="OnLoadCfgAlarmoutSchedule()";b=new Array("ctrl_time.js","cfg_schedule.js","ctrl_calendar.js","ctrl_schedule.js")}else{if((g_curConfigIndex==6)||(g_curConfigIndex==61)){OnLoadCfg="OnLoadCfgNetwork()";b=new Array("cfg_net.js","ctrl_multi_edit.js")}else{if(g_curConfigIndex==62){OnLoadCfg="OnLoadCfgNetStream()";b=new Array("cfg_net.js")}else{if(g_curConfigIndex==63){OnLoadCfg="OnLoadCfgMail()";b=new Array("cfg_net.js")}else{if((g_curConfigIndex==7)||(g_curConfigIndex==71)){OnLoadCfg="OnLoadCfgPtzBasic()";b=new Array("cfg_ptz.js","ctrl_slider.js")}else{if(g_curConfigIndex==72){OnLoadCfg="OnLoadCfgPtzAdvance()";b=new Array("cfg_ptz.js","ctrl_slider.js")}else{if(g_curConfigIndex==8){OnLoadCfg="OnLoadCfgUser()";b=new Array("cfg_user.js","ctrl_multi_edit.js","ctrl_list.js")}else{if(g_curConfigIndex==9){OnLoadCfg="OnloadWebCfg()";b=new Array("backup.js","web_cfg.js")}else{if(g_curConfigIndex==10){OnLoadCfg="OnLoadCfgAdvance()";b=new Array("backup.js","ctrl_time.js","cfg_advance.js")}else{if(g_curConfigIndex==11){OnLoadCfg="OnLoadCfgAdvanceBan()";b=new Array("cfg_advance.js")}else{if(g_curConfigIndex==73){OnLoadCfg="OnLoadManualAlarm()";b=new Array("cfg_manual_alarm.js")}else{if(g_curConfigIndex==74){OnLoadCfg="OnLoadWireless()";b=new Array("cfg_net.js")}else{if(g_curConfigIndex==75){OnLoadCfg="OnLoadCfgServer()";b=new Array("cfg_net.js")}else{if(g_curConfigIndex==76){OnLoadCfg="OnLoadCfgFtp()";b=new Array("cfg_net_ftp.js")}else{if(g_curConfigIndex==77){OnLoadCfg="OnLoadCfgNAT()";b=new Array("cfg_net.js")}else{if(g_curConfigIndex==12){OnLoadCfg="OnLoadCfgDevice()";b=new Array("cfg_device.js","ctrl_list.js")}else{StopWait();return}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}LoadMultiJSSync(b);OnLoadFun()}function OnLoadFun(){eval(OnLoadCfg);StopWait()}function OnSaveConfig(){var t=/msie/i.test(navigator.userAgent);var I=0;var J=g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter");if(g_curConfigIndex==1){var f=document.getElementById("sysconfig_errortips");var F=document.getElementById("video_format");if(t){f.innerText=""}else{f.textContent=""}var o="";if(!ConstSyslen()){return}if(temp_video_format!=F.value){var o=str_change_format_tip}if(o!=""){if(confirm(o)){UpdateValues(J,false);UpdateLiveTimeInfo(J,false);I=f;location.href="#sysconfig_errortips";g_bChange=false}else{RecoverCfg();g_bChange=false;b_change1=false;b_change2=false;b_change3=false;return}}else{if(!g_bChange){SaveError(f,cfg_nochange_tip);location.href="#sysconfig_errortips";return}else{UpdateValues(J,false);UpdateLiveTimeInfo(J,false);I=f;location.href="#sysconfig_errortips";g_bChange=false}}}else{if(g_curConfigIndex==2){var z=document.getElementById("channelconfig_errortips");var A=document.getElementById("live_all_cfg");if(t){z.innerText=""}else{z.textContent=""}if(!g_bChange){SaveError(z,cfg_nochange_tip);location.href="#channelconfig_errortips";return}if(!ConstLivelen()){return}else{UpdateValues(J,false);if(A.checked){allSave(new Array("all_show_channel_name"),g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),false)}I=z;location.href="#channelconfig_errortips";g_bChange=false}}else{if((g_curConfigIndex==3)||(g_curConfigIndex==32)){var S=document.getElementById("rec_streamCfg_errortips");if(t){S.innerText=""}else{S.textContent=""}if(!g_bChange){SaveError(S,cfg_nochange_tip);location.href="#rec_streamCfg_errortips";return}else{UpdateValues(J,false);UpdateRecStreamCfg(false);I=S;location.href="#rec_streamCfg_errortips";g_bChange=false}}else{if(g_curConfigIndex==31){var r=document.getElementById("recConfig_errortips");var U=document.getElementById("rec_all_cfg");if(t){r.innerText=""}else{r.textContent=""}if(!g_bChange){SaveError(r,cfg_nochange_tip);location.href="#recConfig_errortips";return}else{UpdateValues(J,false);if(U.checked){var Q=new Array("all_rec_enable","all_rec_has_audio","all_rec_redundant","all_pre_alarm_rec_time","all_post_alarm_rec_time","all_rec_hold_time");allSave(Q,g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),false)}I=r;location.href="#recConfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==33){var s=document.getElementById("rec_osdCfg_errortips");if(t){s.innerText=""}else{s.textContent=""}if(!g_bChange){SaveError(s,cfg_nochange_tip);location.href="#rec_osdCfg_errortips";return}else{UpdateOsdInfo(J,false);I=s;location.href="#rec_osdCfg_errortips";g_bChange=false}}else{if((g_curConfigIndex==4)||(g_curConfigIndex==41)||(g_curConfigIndex==42)||(g_curConfigIndex==43)||(g_curConfigIndex==56)||(g_curConfigIndex==57)||(g_curConfigIndex==58)||(g_curConfigIndex==59)){var g=document.getElementById("sch_errortips");if(t){g.innerText=""}else{g.textContent=""}UpdateSchedule(J,false,g_curSchChannel,g_curSchType);SaveOk(g);I=g;location.href="#sch_errortips";g_bChange=false}else{if((g_curConfigIndex==52)||(g_curConfigIndex==5)){var w=document.getElementById("motionConfig_errortips");var C=document.getElementById("motion_all_cfg");if(t){w.innerText=""}else{w.textContent=""}if((!g_bChange)&&(!bTrigger)){SaveError(w,cfg_nochange_tip);location.href="#motionConfig_errortips";return}UpdateValues(J,false);if(bTrigger){onMotionPTZSave()}if(C.checked){var Q=new Array("all_motion_enable","all_motion_hold_time");allSave(Q,g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),false)}I=w;location.href="#motionConfig_errortips";g_bChange=false;bTrigger=false}else{if(g_curConfigIndex==51){var T=document.getElementById("alarmoutconfig_errortips");var y=document.getElementById("alarm_out_all_cfg");if(t){T.innerText=""}else{T.textContent=""}if(!g_bChange){SaveError(T,cfg_nochange_tip);location.href="#alarmoutconfig_errortips";return}if(!ConstAlarmoutlen()){return}else{UpdateValues(J,false);if(y.checked){var Q=new Array("all_alarmout_hold_time");allSave(Q,g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),true)}I=T;g_bChange=false}}else{if(g_curConfigIndex==53){var H=document.getElementById("sensorconfig_errortips");var O=document.getElementById("sensor_all_cfg");if(t){H.innerText=""}else{H.textContent=""}if((!g_bChange)&&(!bTrigger)){SaveError(H,cfg_nochange_tip);location.href="#sensorconfig_errortips";return}if(!ConstSensorLen()){return}else{UpdateValues(J,false);if(bTrigger){onSensorPTZSave()}if(O.checked){if(g_US02){var Q=new Array("all_sensor_in_enable","all_sensor_in_type")}else{var Q=new Array("all_sensor_in_enable","all_sensor_in_type","all_sensor_in_hold_time")}allSave(Q,g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"),false);for(k=0;k<g_bUpdataChannel.length;k++){g_bUpdataChannel[k]=1}UpdateBooleanTrigger(J,STR_SENSER_IN_BUZZ,STR_SENSER_IN_BUZZ+"_ctrl",false);UpdateBooleanTrigger(J,STR_SENSOR_IN_TO_EMAIL,STR_SENSOR_IN_TO_EMAIL+"_ctrl",false);UpdateAlarmTrigger(J,STR_SENSOR_IN_TO_ALARM_OUT,STR_SENSOR_IN_TO_ALARM_OUT+"_ctrl",false);UpdateAlarmTrigger(J,STR_SENSOR_IN_TO_RECORD,STR_SENSOR_IN_TO_RECORD+"_ctrl",false);UpdateAlarmTrigger(J,STR_SENSOR_IN_TO_SNAP,STR_SENSOR_IN_TO_SNAP+"_ctrl",false);UpdateBigView(J,STR_SENSOR_IN_TO_BIGVIEW,STR_SENSOR_IN_TO_BIGVIEW+"_ctrl",false);UpdateAlarmToPtz(J,false,g_curchannel_sensor)}I=H;location.href="#sensorconfig_errortips";g_bChange=false;bTrigger=false}}else{if(g_curConfigIndex==54){var M=document.getElementById("vlossAlarmConfig_errortips");if(t){M.innerText=""}else{M.textContent=""}if(bTrigger==false){SaveError(M,cfg_nochange_tip);location.href="#vlossAlarmConfig_errortips";return}else{onVlossPTZSave();I=M;location.href="#vlossAlarmConfig_errortips";g_bChange=false;bTrigger=false}}else{if(g_curConfigIndex==55){var G=document.getElementById("otherAlarmConfig_errortips");if(t){G.innerText=""}else{G.textContent=""}if(!g_bChange){SaveError(G,cfg_nochange_tip);location.href="#otherAlarmConfig_errortips";return}else{if(g_alarmType==1){UpdateOtherAlarm(J,false,STR_DISK_FULL_BUZZER,STR_DISK_FULL_TO_EMAIL,STR_DISK_FULL_TO_ALARM_OUT)}if(g_alarmType==2){UpdateOtherAlarm(J,false,STR_IP_CONFLICT_BUZZER,STR_IP_CONFLICT_TO_EMAIL,STR_IP_CONFLICT_TO_ALARM_OUT)}if(g_alarmType==3){UpdateOtherAlarm(J,false,STR_DISCONNECT_BUZZER,STR_DISCONNECT_TO_EMAIL,STR_DISCONNECT_TO_ALARM_OUT)}if(g_alarmType==4){UpdateOtherAlarm(J,false,STR_DISK_WARNING_BUZZER,STR_DISK_WARNING_TO_EMAIL,STR_DISK_WARNING_TO_ALARM_OUT)}if(g_alarmType==5){UpdateOtherAlarm(J,false,STR_DISK_DISCONNECT_BUZZER,STR_DISK_DISCONNECT_TO_EMAIL,STR_DISK_DISCONNECT_TO_ALARM_OUT)}I=G;location.href="#otherAlarmConfig_errortips";g_bChange=false}}else{if((g_curConfigIndex==6)||(g_curConfigIndex==61)){var n=document.getElementById("netconfig_errortips");var b=document.getElementById("ddns_username");var l=document.getElementById("ddns_register_btn");var K=document.getElementById("ddns_email");if(t){n.innerText=""}else{n.textContent=""}if(!g_bChange){SaveError(n,cfg_nochange_tip);location.href="#netconfig_errortips";return}if(!ConstNetConfiglen()){return}else{if(document.getElementsByName("pppoe_enable")[0].checked){if(document.getElementsByName("pppoe_username")[0].value==""){window.alert(user_name_empty_tip);return}}if(document.getElementsByName("ddns_enable")[0].checked){if((b.value=="")&&(l.style.display=="none")){window.alert(user_name_empty_tip);return}var e=document.getElementById("ddns_type");var h=false;for(i=0;i<e.length;i++){if(e.options[i].selected){if(g_ddnsDomainInfo[i].ddnsId!="17"){h=true;if((l.style.display!="none")&&(K.value=="")){return}}}}}if(!confirm(str_disconnect_after_config)){return}if(h&&document.getElementsByName("ddns_enable")[0].checked&&!NetworkTestDDNS(true)){SaveError(n,save_error_tip);return}UpdateValues(J,false);UpdateNetwork(false);UpdateWirelessNetwork(false);I=n;location.href="#netconfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==62){var q=document.getElementById("net_stream_config_errortips");q.innerText="";if(!g_bChange){SaveError(q,cfg_nochange_tip);location.href="#net_stream_config_errortips";return}else{UpdateValues(J,false);UpdateNetStreamCfg(false);I=q;location.href="#net_stream_config_errortips";g_bChange=false}}else{if(g_curConfigIndex==63){var c=document.getElementById("mailconfig_errortips");if(t){c.innerText=""}else{c.textContent=""}if(!g_bChange){SaveError(c,cfg_nochange_tip);location.href="#mailconfig_errortips";return}else{UpdateNetMail(J,false);I=c;location.href="#mailconfig_errortips";g_bChange=false}}else{if((g_curConfigIndex==7)||(g_curConfigIndex==71)){var E=document.getElementById("ptzconfig_errortips");if(t){E.innerText=""}else{E.textContent=""}if(!g_bChange){SaveError(E,cfg_nochange_tip);location.href="#ptzconfig_errortips";return}else{UpdatePtzConfig(J,false);I=E;location.href="#ptzconfig_errortips";g_bChange=false;bAddTest=false}}else{if(g_curConfigIndex==72){var m=document.getElementById("ptzAdvConfig_errortips");if(t){m.innerText=""}else{m.textContent=""}if(!g_bChange){SaveError(m,cfg_nochange_tip);location.href="#ptzAdvConfig_errortips";return}else{PresetSave(g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"));CruiseSave(g_xmlDoc.documentElement.getElementsByTagName("command")[0].getElementsByTagName("parameter"));I=m;location.href="#ptzAdvConfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==75){var B=document.getElementById("serverconfig_errortips");if(t){B.innerText=""}else{B.textContent=""}if(!g_bChange){SaveError(B,cfg_nochange_tip);location.href="#serverconfig_errortips";return}else{UpdateAutoReport(false);I=B;location.href="#serverconfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==76){var a=document.getElementById("ftpconfig_errortips");if(t){a.innerText=""}else{a.textContent=""}if(!g_bChange){SaveError(a,cfg_nochange_tip);location.href="#ftpconfig_errortips";return}else{UpdateFtpValues(false);I=a;location.href="#ftpconfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==77){var u=document.getElementById("natconfig_errortips");if(t){u.innerText=""}else{u.textContent=""}if(!g_bChange){SaveError(u,cfg_nochange_tip);location.href="#natconfig_errortips";return}else{UpdateNATConfigInfo(false);I=u;location.href="#natconfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==8){var x=document.getElementById("userconfig_errortips");if(t){x.innerText=""}else{x.textContent=""}OnSaveUserConfig();I=x;location.href="#userconfig_errortips";g_bChange=false}else{if(g_curConfigIndex==11){var R=document.getElementById("advanceconfig_errortips");if(t){R.innerText=""}else{R.textContent=""}if(!g_bChange){SaveError(R,cfg_nochange_tip);location.href="#advanceconfig_errortips";return}else{UpdateValues(J,false);UpdateBWList(J,false);I=R;location.href="#advanceconfig_errortips";g_bChange=false}}else{if(g_curConfigIndex==34){var d=document.getElementById("recSnap_errortips");if(t){d.innerText=""}else{d.textContent=""}if(!g_bChange){SaveError(d,cfg_nochange_tip);location.href="#recSnap_errortips";return}else{UpdateSnap(J,false);I=d;location.href="#recSnap_errortips";g_bChange=false}}else{return}}}}}}}}}}}}}}}}}}}}}}var N=g_xmlDoc.getElementsByTagName("command");for(i=0;i<N.length;i++){N[i].setAttribute("name",STR_REQUEST_CONFIG_SET)}var L="";if(t){L=g_xmlDoc.xml}else{L=serializeXml(g_xmlDoc);delete g_oSerializer;g_oSerializer=null}var D=WebClient.ExcuteCmd(L);if(D==""){SaveError(I,str_net_disconnected)}else{var p;p=FormatToXmlDOM(D);p.async=false;var P=p.documentElement.getElementsByTagName("command")[0];var v=P.getAttribute("name");if(STR_REPLY_CONFIG_SUCC==v){SaveOk(I)}else{if(STR_CFG_NO_CHANGE==v){SaveError(I,cfg_nochange_tip)}else{SaveError(I,save_error_tip)}}if(p!=null){delete p;p=null}}}function HintSave(a){if(a==g_curConfigIndex){return}if(g_bChange||bTrigger||bDChanged){if(confirm(save_confirm)){if(g_curConfigIndex==9){OnSaveWebCfg()}if(g_curConfigIndex==12){SetDeviceInfo()}else{OnSaveConfig()}}else{g_bChange=false;bTrigger=false;bDChanged=false}}if(g_curConfigIndex!=-1){if(typeof g_bInPtzCfg!="undefined"){if(g_bInPtzCfg&&(a.toString().charAt(0)!="7")){PTZCfg(false);g_bInPtzCfg=false}if(g_bPreviewCruise){RecoverCruisePreview()}}if(g_curConfigIndex==12){OnDeviceExit()}if((g_curConfigIndex!=9)&&(g_curConfigIndex!=12)){OnConfigExit()}}}function onCopySave(a){selectchannel=a.value;if(selectchannel=="All"){for(k=0;k<g_bUpdataChannel.length;k++){g_bUpdataChannel[k]=1}}else{g_bUpdataChannel[selectchannel]=1}}function allSave(b,d,e){for(i=0;i<d.length;i++){if(d[i].attributes==null){continue}if(d[i].attributes.getNamedItem("name")==null){continue}HtmlName=d[i].attributes.getNamedItem("name").nodeValue;if(!e){for(j=0;j<b.length;j++){var c=b[j].substr(4);var f=document.getElementsByName(c);if(HtmlName==c){var a=document.getElementById(b[j]);if(f[0].type=="checkbox"){if((d[i].childNodes[0].nodeValue=="0")||(d[i].childNodes[0].nodeValue=="1")){if(a.checked){d[i].childNodes[0].nodeValue="1"}else{d[i].childNodes[0].nodeValue="0"}}}else{if(d[i].childNodes[0]==null){var g=g_xmlDoc.createTextNode(htmlElementsNodeName[index].value);d[i].appendChild(g)}else{d[i].childNodes[0].nodeValue=a.value}}}}}else{for(j=0;j<b.length;j++){var c=b[j].substr(4);var f=document.getElementsByName(c);if(HtmlName==c){var a=document.getElementsByName(b[j]);if(f[0].type=="checkbox"){if((d[i].childNodes[0].nodeValue=="0")||(d[i].childNodes[0].nodeValue=="1")){if(a[0].checked){d[i].childNodes[0].nodeValue="1"}else{d[i].childNodes[0].nodeValue="0"}}}else{if(d[i].childNodes[0]==null){var g=g_xmlDoc.createTextNode(htmlElementsNodeName[index].value);d[i].appendChild(g)}else{d[i].childNodes[0].nodeValue=a[0].value}}}}}}}function cfgCopy2All(g,c,b){if(g.checked){var a=c.getElementsByTagName("input");for(var e=0;e<a.length;e++){if((a[e].type=="checkbox")||(a[e].type=="button")){a[e].disabled="disabled"}}var f=c.getElementsByTagName("select");for(var e=0;e<f.length;e++){f[e].disabled="disabled"}var h=b.getElementsByTagName("input");for(var e=0;e<h.length;e++){if((h[e].type=="checkbox")||(h[e].type=="button")){h[e].disabled=false}if(h[e].type=="button"){h[e].style.color=btn_text_normal_color}}var d=b.getElementsByTagName("select");for(var e=0;e<d.length;e++){d[e].disabled=false}}else{a=c.getElementsByTagName("input");for(var e=0;e<a.length;e++){if((a[e].type=="checkbox")||(a[e].type=="button")){a[e].disabled=false}}f=c.getElementsByTagName("select");for(var e=0;e<f.length;e++){f[e].disabled=false}var h=b.getElementsByTagName("input");for(var e=0;e<h.length;e++){if(h[e]!=g){h[e].disabled="disabled"}if(h[e].type=="button"){h[e].style.color=btn_text_disabled_color}}var d=b.getElementsByTagName("select");for(var e=0;e<d.length;e++){d[e].disabled="disabled"}}}function Align(){var e=document.getElementById("div_config");var d=document.getElementById("div_config_index");var a=document.getElementById("div_config_body");var b=document.getElementById("div_config_index_height");e.style.height="";d.style.height="";a.style.height="";var b=(d.offsetHeight<a.offsetHeight)?a.offsetHeight:d.offsetHeight;if((g_ch_num==4||g_ch_num==8)&&(b<720)){b=720}var h;if(g_curConfigIndex!=10){h=b+10}else{h=b+40}document.getElementById("div_config_index").style.height=h+"px";var f=(a.offsetHeight<d.offsetHeight-2)?d.offsetHeight-2:a.offsetHeight;document.getElementById("div_config_body").style.height=f+"px";var g=f+30;document.getElementById("div_config").style.height=g+"px";var c=/msie/i.test(navigator.userAgent);if(!c){var g=f+70;document.getElementById("work_area").style.height=g+"px"}}function HisDiv(b){var a=document.getElementById("div_config_index");b.style.display="none";Align();EdgeCtrl(a,72)}function GetDefaultCfg(c){var e=CreateConfigReqXml(c,STR_REQUEST_DEFAULT_CONFIG);var a=WebClient.ExcuteCmd(e);if(a==""){window.alert(str_net_disconnected);return false}var d;d=FormatToXmlDOM(a);d.async=false;var b=d.documentElement.getElementsByTagName("command")[0];delete d;if(b.attributes.getNamedItem("name").nodeValue!=STR_REPLY_CONFIG_GET){window.alert("get default config failed!");return false}if(g_xmlDoc!=null){delete g_xmlDoc;g_xmlDoc=null}g_xmlDoc=FormatToXmlDOM(a);return true};